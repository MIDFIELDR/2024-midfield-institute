<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>MIDFIELD Institute - Reshaping transforms</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./r-resources.html" rel="next">
<link href="./data-shaping-04-multi-table-transforms.html" rel="prev">
<link href="./figures/logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MIDFIELD Institute</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/MIDFIELDR/2024-midfield-institute"> <i class="bi bi-git" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-shaping-01-data-selection.html">Shaping data 3 ways</a></li><li class="breadcrumb-item"><a href="./data-shaping-05-reshaping-transforms.html">Reshaping transforms</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./before-you-arrive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Before you arrive</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./agenda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Program</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial links</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chart-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R chart basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R data basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://midfieldr.github.io/midfieldr/articles/art-001-case-goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case study goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://midfieldr.github.io/midfieldr/articles/art-002-case-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case study data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://midfieldr.github.io/midfieldr/articles/art-003-case-results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case study results</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://midfieldr.github.io/midfieldr/articles/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Post-workshop tutorials</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Shaping data 3 ways</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-shaping-01-data-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-shaping-02-basic-transforms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic transforms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-shaping-03-aggregating-transforms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aggregating transforms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-shaping-04-multi-table-transforms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multi-table transforms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-shaping-05-reshaping-transforms.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Reshaping transforms</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
<li><a href="#terminology" id="toc-terminology" class="nav-link active" data-scroll-target="#terminology">Terminology</a></li>
  <li><a href="#why-transform" id="toc-why-transform" class="nav-link" data-scroll-target="#why-transform">Why transform?</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#blocks-to-row-records" id="toc-blocks-to-row-records" class="nav-link" data-scroll-target="#blocks-to-row-records">Blocks to row-records</a></li>
  <li><a href="#row-records-to-blocks" id="toc-row-records-to-blocks" class="nav-link" data-scroll-target="#row-records-to-blocks">Row-records to blocks</a></li>
  <li><a href="#midfield-data-keys" id="toc-midfield-data-keys" class="nav-link" data-scroll-target="#midfield-data-keys">MIDFIELD data keys</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps">Next steps</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/MIDFIELDR/2024-midfield-institute/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-shaping-01-data-selection.html">Shaping data 3 ways</a></li><li class="breadcrumb-item"><a href="./data-shaping-05-reshaping-transforms.html">Reshaping transforms</a></li></ol></nav><div class="quarto-title">
<h1 class="title">Reshaping transforms</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="figures/data-shaping-5.png" class="img-fluid figure-img"></p>
<figcaption>Image: <em>SAREC field day 2018</em> by Univ Wyoming Extension CT is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/2.0/">CC BY-NC-ND 2.0</a></figcaption></figure>
</div>
<p>Using <strong>cdata</strong>, <strong>data.table</strong>, and <strong>dplyr/tidyr</strong> to transform MIDFIELD data as needed for your analysis (no base R transforms in this section).</p>
<p>In this section, we cover reshaping data frames by moving data between rows and columns, often called <em>pivoting</em>.</p>
<section id="terminology" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="terminology">Terminology</h2>
<p>Pivoting operations go by a number of different names, as listed in Table 1 <span class="citation" data-cites="Mount+Zumel:2019:fluid-data">(<a href="#ref-Mount+Zumel:2019:fluid-data" role="doc-biblioref">Mount &amp; Zumel, 2019</a>)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="mrdxmhxges" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mrdxmhxges table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mrdxmhxges thead, #mrdxmhxges tbody, #mrdxmhxges tfoot, #mrdxmhxges tr, #mrdxmhxges td, #mrdxmhxges th {
  border-style: none;
}

#mrdxmhxges p {
  margin: 0;
  padding: 0;
}

#mrdxmhxges .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mrdxmhxges .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mrdxmhxges .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mrdxmhxges .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mrdxmhxges .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mrdxmhxges .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#mrdxmhxges .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mrdxmhxges .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mrdxmhxges .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mrdxmhxges .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mrdxmhxges .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mrdxmhxges .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mrdxmhxges .gt_spanner_row {
  border-bottom-style: hidden;
}

#mrdxmhxges .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mrdxmhxges .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  vertical-align: middle;
}

#mrdxmhxges .gt_from_md > :first-child {
  margin-top: 0;
}

#mrdxmhxges .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mrdxmhxges .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #D5D5D5;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D5D5D5;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D5D5D5;
  vertical-align: middle;
  overflow-x: hidden;
}

#mrdxmhxges .gt_stub {
  color: #FFFFFF;
  background-color: #5F5F5F;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #5F5F5F;
  padding-left: 5px;
  padding-right: 5px;
}

#mrdxmhxges .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mrdxmhxges .gt_row_group_first td {
  border-top-width: 2px;
}

#mrdxmhxges .gt_row_group_first th {
  border-top-width: 2px;
}

#mrdxmhxges .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrdxmhxges .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #5F5F5F;
}

#mrdxmhxges .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mrdxmhxges .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#mrdxmhxges .gt_grand_summary_row {
  color: #333333;
  background-color: #D5D5D5;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrdxmhxges .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #5F5F5F;
}

#mrdxmhxges .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #5F5F5F;
}

#mrdxmhxges .gt_striped {
  background-color: #F4F4F4;
}

#mrdxmhxges .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#mrdxmhxges .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mrdxmhxges .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrdxmhxges .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mrdxmhxges .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mrdxmhxges .gt_left {
  text-align: left;
}

#mrdxmhxges .gt_center {
  text-align: center;
}

#mrdxmhxges .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mrdxmhxges .gt_font_normal {
  font-weight: normal;
}

#mrdxmhxges .gt_font_bold {
  font-weight: bold;
}

#mrdxmhxges .gt_font_italic {
  font-style: italic;
}

#mrdxmhxges .gt_super {
  font-size: 65%;
}

#mrdxmhxges .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mrdxmhxges .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mrdxmhxges .gt_indent_1 {
  text-indent: 5px;
}

#mrdxmhxges .gt_indent_2 {
  text-indent: 10px;
}

#mrdxmhxges .gt_indent_3 {
  text-indent: 15px;
}

#mrdxmhxges .gt_indent_4 {
  text-indent: 20px;
}

#mrdxmhxges .gt_indent_5 {
  text-indent: 25px;
}

#mrdxmhxges .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mrdxmhxges div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Table 1: Reshaping operations</caption>
<thead><tr class="header gt_col_headings">
<th id="System" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">System</th>
<th id="Pivot &quot;wider&quot;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Pivot "wider"</th>
<th id="Pivot &quot;longer&quot;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Pivot "longer"</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="System">colloquially called</td>
<td class="gt_row gt_left" headers="Pivot " data-wider="">"tall to wide"</td>
<td class="gt_row gt_left" headers="Pivot " data-longer="">"wide to tall"</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="System">Microsoft Excel</td>
<td class="gt_row gt_left gt_striped" headers="Pivot " data-wider="">pivot</td>
<td class="gt_row gt_left gt_striped" headers="Pivot " data-longer="">un-pivot</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="System">databases</td>
<td class="gt_row gt_left" headers="Pivot " data-wider="">pivot</td>
<td class="gt_row gt_left" headers="Pivot " data-longer="">anti-pivot</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="System">databases</td>
<td class="gt_row gt_left gt_striped" headers="Pivot " data-wider="">crosstab</td>
<td class="gt_row gt_left gt_striped" headers="Pivot " data-longer="">shred</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="System">R</td>
<td class="gt_row gt_left" headers="Pivot " data-wider="">unstack</td>
<td class="gt_row gt_left" headers="Pivot " data-longer="">stack</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="System">reshape, reshape2</td>
<td class="gt_row gt_left gt_striped" headers="Pivot " data-wider="">cast</td>
<td class="gt_row gt_left gt_striped" headers="Pivot " data-longer="">melt</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><br></p>
<p>Pivoting is possible in base R but the package versions in data.table, tidyr, and cdata are significantly better tools. Table 2 lists the reshaping functions we use in this work.</p>
<div class="cell">
<div class="cell-output-display">
<div id="divzblgjcj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#divzblgjcj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#divzblgjcj thead, #divzblgjcj tbody, #divzblgjcj tfoot, #divzblgjcj tr, #divzblgjcj td, #divzblgjcj th {
  border-style: none;
}

#divzblgjcj p {
  margin: 0;
  padding: 0;
}

#divzblgjcj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#divzblgjcj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#divzblgjcj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#divzblgjcj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#divzblgjcj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#divzblgjcj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#divzblgjcj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#divzblgjcj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#divzblgjcj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#divzblgjcj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#divzblgjcj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#divzblgjcj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#divzblgjcj .gt_spanner_row {
  border-bottom-style: hidden;
}

#divzblgjcj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#divzblgjcj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  vertical-align: middle;
}

#divzblgjcj .gt_from_md > :first-child {
  margin-top: 0;
}

#divzblgjcj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#divzblgjcj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #D5D5D5;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D5D5D5;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D5D5D5;
  vertical-align: middle;
  overflow-x: hidden;
}

#divzblgjcj .gt_stub {
  color: #FFFFFF;
  background-color: #5F5F5F;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #5F5F5F;
  padding-left: 5px;
  padding-right: 5px;
}

#divzblgjcj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#divzblgjcj .gt_row_group_first td {
  border-top-width: 2px;
}

#divzblgjcj .gt_row_group_first th {
  border-top-width: 2px;
}

#divzblgjcj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#divzblgjcj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #5F5F5F;
}

#divzblgjcj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#divzblgjcj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#divzblgjcj .gt_grand_summary_row {
  color: #333333;
  background-color: #D5D5D5;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#divzblgjcj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #5F5F5F;
}

#divzblgjcj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #5F5F5F;
}

#divzblgjcj .gt_striped {
  background-color: #F4F4F4;
}

#divzblgjcj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#divzblgjcj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#divzblgjcj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#divzblgjcj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#divzblgjcj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#divzblgjcj .gt_left {
  text-align: left;
}

#divzblgjcj .gt_center {
  text-align: center;
}

#divzblgjcj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#divzblgjcj .gt_font_normal {
  font-weight: normal;
}

#divzblgjcj .gt_font_bold {
  font-weight: bold;
}

#divzblgjcj .gt_font_italic {
  font-style: italic;
}

#divzblgjcj .gt_super {
  font-size: 65%;
}

#divzblgjcj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#divzblgjcj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#divzblgjcj .gt_indent_1 {
  text-indent: 5px;
}

#divzblgjcj .gt_indent_2 {
  text-indent: 10px;
}

#divzblgjcj .gt_indent_3 {
  text-indent: 15px;
}

#divzblgjcj .gt_indent_4 {
  text-indent: 20px;
}

#divzblgjcj .gt_indent_5 {
  text-indent: 25px;
}

#divzblgjcj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#divzblgjcj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Table 2: Reshaping functions we use</caption>
<thead><tr class="header gt_col_headings">
<th id="R package" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">R package</th>
<th id="Pivot &quot;wider&quot;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Pivot "wider"</th>
<th id="Pivot &quot;longer&quot;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Pivot "longer"</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="R package">data.table</td>
<td class="gt_row gt_left" headers="Pivot " data-wider="">dcast()</td>
<td class="gt_row gt_left" headers="Pivot " data-longer="">melt()</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="R package">tidyr</td>
<td class="gt_row gt_left gt_striped" headers="Pivot " data-wider="">pivot_wider()</td>
<td class="gt_row gt_left gt_striped" headers="Pivot " data-longer="">pivot_longer()</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="R package">cdata</td>
<td class="gt_row gt_left" headers="Pivot " data-wider="">pivot_to_rowrecs()</td>
<td class="gt_row gt_left" headers="Pivot " data-longer="">unpivot_to_blocks()</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><br></p>
<p>The data set we use in this section is shown in Table 3, where “starters” is the number of students starting in an engineering program, “ever enrolled” is the number who were enrolled at least one term in the program, and “graduates” is the number graduating from that program.</p>
<div class="cell no-stripe">
<div class="cell-output-display">
<div id="ewsvqrtezy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ewsvqrtezy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ewsvqrtezy thead, #ewsvqrtezy tbody, #ewsvqrtezy tfoot, #ewsvqrtezy tr, #ewsvqrtezy td, #ewsvqrtezy th {
  border-style: none;
}

#ewsvqrtezy p {
  margin: 0;
  padding: 0;
}

#ewsvqrtezy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ewsvqrtezy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ewsvqrtezy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ewsvqrtezy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ewsvqrtezy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ewsvqrtezy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#ewsvqrtezy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ewsvqrtezy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ewsvqrtezy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ewsvqrtezy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ewsvqrtezy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ewsvqrtezy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ewsvqrtezy .gt_spanner_row {
  border-bottom-style: hidden;
}

#ewsvqrtezy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ewsvqrtezy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  vertical-align: middle;
}

#ewsvqrtezy .gt_from_md > :first-child {
  margin-top: 0;
}

#ewsvqrtezy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ewsvqrtezy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #D5D5D5;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D5D5D5;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D5D5D5;
  vertical-align: middle;
  overflow-x: hidden;
}

#ewsvqrtezy .gt_stub {
  color: #FFFFFF;
  background-color: #5F5F5F;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #5F5F5F;
  padding-left: 5px;
  padding-right: 5px;
}

#ewsvqrtezy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ewsvqrtezy .gt_row_group_first td {
  border-top-width: 2px;
}

#ewsvqrtezy .gt_row_group_first th {
  border-top-width: 2px;
}

#ewsvqrtezy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ewsvqrtezy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #5F5F5F;
}

#ewsvqrtezy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ewsvqrtezy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#ewsvqrtezy .gt_grand_summary_row {
  color: #333333;
  background-color: #D5D5D5;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ewsvqrtezy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #5F5F5F;
}

#ewsvqrtezy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #5F5F5F;
}

#ewsvqrtezy .gt_striped {
  background-color: #F4F4F4;
}

#ewsvqrtezy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#ewsvqrtezy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ewsvqrtezy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ewsvqrtezy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ewsvqrtezy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ewsvqrtezy .gt_left {
  text-align: left;
}

#ewsvqrtezy .gt_center {
  text-align: center;
}

#ewsvqrtezy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ewsvqrtezy .gt_font_normal {
  font-weight: normal;
}

#ewsvqrtezy .gt_font_bold {
  font-weight: bold;
}

#ewsvqrtezy .gt_font_italic {
  font-style: italic;
}

#ewsvqrtezy .gt_super {
  font-size: 65%;
}

#ewsvqrtezy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ewsvqrtezy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ewsvqrtezy .gt_indent_1 {
  text-indent: 5px;
}

#ewsvqrtezy .gt_indent_2 {
  text-indent: 10px;
}

#ewsvqrtezy .gt_indent_3 {
  text-indent: 15px;
}

#ewsvqrtezy .gt_indent_4 {
  text-indent: 20px;
}

#ewsvqrtezy .gt_indent_5 {
  text-indent: 25px;
}

#ewsvqrtezy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ewsvqrtezy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Table 3. Row-records form</caption>
<thead><tr class="header gt_col_headings">
<th id="program" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="background-color: #D8DAEB" scope="col">program</th>
<th id="starters" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="background-color: #80CDC1" scope="col">starters</th>
<th id="ever_enrolled" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="background-color: #DFC27D" scope="col">ever_enrolled</th>
<th id="graduates" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="background-color: #C2A5CF" scope="col">graduates</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="program" style="background-color: #D9D9D9">Civil</td>
<td class="gt_row gt_right" headers="starters" style="background-color: #C7EAE5">983</td>
<td class="gt_row gt_right" headers="ever_enrolled" style="background-color: #F6E8C3">1504</td>
<td class="gt_row gt_right" headers="graduates" style="background-color: #E7D4E8">936</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="program" style="background-color: #D9D9D9">Electrical</td>
<td class="gt_row gt_right gt_striped" headers="starters" style="background-color: #C7EAE5">1080</td>
<td class="gt_row gt_right gt_striped" headers="ever_enrolled" style="background-color: #F6E8C3">1490</td>
<td class="gt_row gt_right gt_striped" headers="graduates" style="background-color: #E7D4E8">736</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="program" style="background-color: #D9D9D9">Industrial</td>
<td class="gt_row gt_right" headers="starters" style="background-color: #C7EAE5">285</td>
<td class="gt_row gt_right" headers="ever_enrolled" style="background-color: #F6E8C3">353</td>
<td class="gt_row gt_right" headers="graduates" style="background-color: #E7D4E8">238</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="program" style="background-color: #D9D9D9">Mechanical</td>
<td class="gt_row gt_right gt_striped" headers="starters" style="background-color: #C7EAE5">1705</td>
<td class="gt_row gt_right gt_striped" headers="ever_enrolled" style="background-color: #F6E8C3">2306</td>
<td class="gt_row gt_right gt_striped" headers="graduates" style="background-color: #E7D4E8">1354</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><br></p>
<p>These data are in “wide” format, with one row per program. In this form, the “coordinates” of a measurement (a count of students) are the value of the primary key (<code>program</code>) and a column name.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;We refer again to Mount &amp; Zumel (2019) for the concept of <em>coordinatized data</em>.</p></div></div><p>In Table 4, these data are transformed to “tall” format, with three rows per program. As indicated by the cell color-coding, the names of three columns in Table 3 are now values in the peer-group column in Table 4 and all counts of students are collected in the N column. In this form, the coordinates of a measurement (<code>N</code>) are given by the composite key (<code>program</code> + <code>peer_group</code>).</p>
<div class="cell no-stripe">
<div class="cell-output-display">
<div id="dvamaqkcdv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dvamaqkcdv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dvamaqkcdv thead, #dvamaqkcdv tbody, #dvamaqkcdv tfoot, #dvamaqkcdv tr, #dvamaqkcdv td, #dvamaqkcdv th {
  border-style: none;
}

#dvamaqkcdv p {
  margin: 0;
  padding: 0;
}

#dvamaqkcdv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #000000;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dvamaqkcdv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dvamaqkcdv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dvamaqkcdv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dvamaqkcdv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dvamaqkcdv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#dvamaqkcdv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dvamaqkcdv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dvamaqkcdv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dvamaqkcdv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dvamaqkcdv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dvamaqkcdv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dvamaqkcdv .gt_spanner_row {
  border-bottom-style: hidden;
}

#dvamaqkcdv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dvamaqkcdv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
  vertical-align: middle;
}

#dvamaqkcdv .gt_from_md > :first-child {
  margin-top: 0;
}

#dvamaqkcdv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dvamaqkcdv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #D5D5D5;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D5D5D5;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D5D5D5;
  vertical-align: middle;
  overflow-x: hidden;
}

#dvamaqkcdv .gt_stub {
  color: #FFFFFF;
  background-color: #5F5F5F;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #5F5F5F;
  padding-left: 5px;
  padding-right: 5px;
}

#dvamaqkcdv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dvamaqkcdv .gt_row_group_first td {
  border-top-width: 2px;
}

#dvamaqkcdv .gt_row_group_first th {
  border-top-width: 2px;
}

#dvamaqkcdv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvamaqkcdv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #5F5F5F;
}

#dvamaqkcdv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dvamaqkcdv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#dvamaqkcdv .gt_grand_summary_row {
  color: #333333;
  background-color: #D5D5D5;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvamaqkcdv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #5F5F5F;
}

#dvamaqkcdv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #5F5F5F;
}

#dvamaqkcdv .gt_striped {
  background-color: #F4F4F4;
}

#dvamaqkcdv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #5F5F5F;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #5F5F5F;
}

#dvamaqkcdv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dvamaqkcdv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvamaqkcdv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dvamaqkcdv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvamaqkcdv .gt_left {
  text-align: left;
}

#dvamaqkcdv .gt_center {
  text-align: center;
}

#dvamaqkcdv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dvamaqkcdv .gt_font_normal {
  font-weight: normal;
}

#dvamaqkcdv .gt_font_bold {
  font-weight: bold;
}

#dvamaqkcdv .gt_font_italic {
  font-style: italic;
}

#dvamaqkcdv .gt_super {
  font-size: 65%;
}

#dvamaqkcdv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dvamaqkcdv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dvamaqkcdv .gt_indent_1 {
  text-indent: 5px;
}

#dvamaqkcdv .gt_indent_2 {
  text-indent: 10px;
}

#dvamaqkcdv .gt_indent_3 {
  text-indent: 15px;
}

#dvamaqkcdv .gt_indent_4 {
  text-indent: 20px;
}

#dvamaqkcdv .gt_indent_5 {
  text-indent: 25px;
}

#dvamaqkcdv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dvamaqkcdv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Table 4. Blocks form</caption>
<thead><tr class="header gt_col_headings">
<th id="program" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="background-color: #D8DAEB" scope="col">program</th>
<th id="peer_group" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="text-align: left; background-color: #D8DAEB;" scope="col">peer_group</th>
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="background-color: #D8DAEB" scope="col">N</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="program" style="background-color: #D9D9D9">Civil</td>
<td class="gt_row gt_center" headers="peer_group" style="text-align: left; background-color: #80CDC1;">starters</td>
<td class="gt_row gt_right" headers="N" style="background-color: #C7EAE5">983</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="program" style="background-color: #D9D9D9">Electrical</td>
<td class="gt_row gt_center gt_striped" headers="peer_group" style="text-align: left; background-color: #80CDC1;">starters</td>
<td class="gt_row gt_right gt_striped" headers="N" style="background-color: #C7EAE5">1080</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="program" style="background-color: #D9D9D9">Industrial</td>
<td class="gt_row gt_center" headers="peer_group" style="text-align: left; background-color: #80CDC1;">starters</td>
<td class="gt_row gt_right" headers="N" style="background-color: #C7EAE5">285</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="program" style="background-color: #D9D9D9; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696">Mechanical</td>
<td class="gt_row gt_center gt_striped" headers="peer_group" style="text-align: left; background-color: #80CDC1; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;">starters</td>
<td class="gt_row gt_right gt_striped" headers="N" style="background-color: #C7EAE5; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696">1705</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="program" style="background-color: #D9D9D9">Civil</td>
<td class="gt_row gt_center" headers="peer_group" style="text-align: left; background-color: #DFC27D;">ever_enrolled</td>
<td class="gt_row gt_right" headers="N" style="background-color: #F6E8C3">1504</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="program" style="background-color: #D9D9D9">Electrical</td>
<td class="gt_row gt_center gt_striped" headers="peer_group" style="text-align: left; background-color: #DFC27D;">ever_enrolled</td>
<td class="gt_row gt_right gt_striped" headers="N" style="background-color: #F6E8C3">1490</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="program" style="background-color: #D9D9D9">Industrial</td>
<td class="gt_row gt_center" headers="peer_group" style="text-align: left; background-color: #DFC27D;">ever_enrolled</td>
<td class="gt_row gt_right" headers="N" style="background-color: #F6E8C3">353</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="program" style="background-color: #D9D9D9; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696">Mechanical</td>
<td class="gt_row gt_center gt_striped" headers="peer_group" style="text-align: left; background-color: #DFC27D; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;">ever_enrolled</td>
<td class="gt_row gt_right gt_striped" headers="N" style="background-color: #F6E8C3; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696">2306</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="program" style="background-color: #D9D9D9">Civil</td>
<td class="gt_row gt_center" headers="peer_group" style="text-align: left; background-color: #C2A5CF;">graduates</td>
<td class="gt_row gt_right" headers="N" style="background-color: #E7D4E8">936</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="program" style="background-color: #D9D9D9">Electrical</td>
<td class="gt_row gt_center gt_striped" headers="peer_group" style="text-align: left; background-color: #C2A5CF;">graduates</td>
<td class="gt_row gt_right gt_striped" headers="N" style="background-color: #E7D4E8">736</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="program" style="background-color: #D9D9D9">Industrial</td>
<td class="gt_row gt_center" headers="peer_group" style="text-align: left; background-color: #C2A5CF;">graduates</td>
<td class="gt_row gt_right" headers="N" style="background-color: #E7D4E8">238</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="program" style="background-color: #D9D9D9; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696">Mechanical</td>
<td class="gt_row gt_center gt_striped" headers="peer_group" style="text-align: left; background-color: #C2A5CF; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;">graduates</td>
<td class="gt_row gt_right gt_striped" headers="N" style="background-color: #E7D4E8; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696">1354</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><br></p>
<p>You can see why “wide” and “tall” are commonly used to describe these two formats. Yet “wider” implies having more columns, and (while true here) that is not always the case.</p>
<p>What <em>is</em> always true is that the first format comprises <strong><em>row records</em></strong>, or one row per primary key, and the second format comprises <strong><em>blocks</em></strong>, or multiple rows per primary key <span class="citation" data-cites="Mount+Zumel:2021:block+row+records">(<a href="#ref-Mount+Zumel:2021:block+row+records" role="doc-biblioref">Mount &amp; Zumel, 2021</a>)</span>. As long as the data are properly “coordinatized”, the transformations are invertible.</p>
<p>In our opinion, <em>blocks</em> and <em>row records</em> describe these data formats more memorably than the alternatives, so we use them to define our transforms as well:</p>
<ul>
<li><p><em>blocks to row-records</em> (i.e., pivoting or “tall to wide”)</p></li>
<li><p><em>row-records to blocks</em> (i.e., un-pivoting or “wide to tall”)</p></li>
</ul></section><section id="why-transform" class="level2"><h2 class="anchored" data-anchor-id="why-transform">Why transform?</h2>
<p>We transform data between blocks and row records to meet specific needs. Most data processing steps, for example, have a preferred format for how data is arranged in rows and columns. Some packages, like <a href="https://CRAN.R-project.org/package=ggplot2">ggplot2</a>, require blocks; others, like the <a href="https://CRAN.R-project.org/package=likert">likert</a> package, require row records if the survey data is in summary form (frequencies counted) but requires blocks if not summarized, i.e., one row per respondent, one column per question.</p>
<p>Row records are generally preferred for publishing a data table such as Table 3 and they support analytical tasks as well. For example, the academic program metric “stickiness” is the ratio of the number of graduates from a program to the number ever enrolled in the program. With a data frame <code>df</code> organized like the Table 3 data, computing stickiness requires one line of code operating on values in the same row, e.g.,</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># base R</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">stickiness</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">graduates</span> <span class="op">/</span> <span class="va">df</span><span class="op">$</span><span class="va">ever_enrolled</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Blocks, on the other hand, are convenient for grouping and summarizing operations and, as stated earlier, are required for making charts with ggplot2. For example, with a data frame <code>blocks</code> organized like the Table 4 data, the three column names are variables used as arguments in the <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> function that appear in the chart on the horizontal scale (N), the vertical scale (programs), and the legend (peer groups).</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">blocks</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>, </span>
<span>                   y <span class="op">=</span> <span class="va">program</span>, </span>
<span>                   color <span class="op">=</span> <span class="va">peer_group</span>, </span>
<span>                   shape <span class="op">=</span> <span class="va">peer_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="data-shaping-05-reshaping-transforms_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="setup" class="level2"><h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p><em>Load</em> packages.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://midfieldr.github.io/midfielddata/">"midfielddata"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com">"data.table"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyr.tidyverse.org">"tidyr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/WinVector/wrapr">"wrapr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/WinVector/cdata/">"cdata"</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Format</em> data as described in the <a href="data-shaping-00-introduction.html">Introduction</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cohort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span><span class="st">"data/three_blocs.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell base">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># base R</span></span>
<span><span class="va">cohort_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">cohort</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell dtbl">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># data.table</span></span>
<span><span class="va">cohort_dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span><span class="op">(</span><span class="va">cohort</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell dplyr">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dplyr</span></span>
<span><span class="va">cohort_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">cohort</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cohort_dt</span></span>
<span><span class="co">#&gt;                  mcid    program peer_group</span></span>
<span><span class="co">#&gt;                &lt;char&gt;     &lt;char&gt;     &lt;char&gt;</span></span>
<span><span class="co">#&gt;     1: MCID3111142965 Electrical   starters</span></span>
<span><span class="co">#&gt;     2: MCID3111145102 Electrical   starters</span></span>
<span><span class="co">#&gt;     3: MCID3111150194 Industrial   starters</span></span>
<span><span class="co">#&gt;     4: MCID3111156083 Electrical   starters</span></span>
<span><span class="co">#&gt;     5: MCID3111156325 Electrical   starters</span></span>
<span><span class="co">#&gt;    ---                                     </span></span>
<span><span class="co">#&gt; 12966: MCID3112618553 Mechanical  graduates</span></span>
<span><span class="co">#&gt; 12967: MCID3112618574 Mechanical  graduates</span></span>
<span><span class="co">#&gt; 12968: MCID3112618976 Mechanical  graduates</span></span>
<span><span class="co">#&gt; 12969: MCID3112619484 Electrical  graduates</span></span>
<span><span class="co">#&gt; 12970: MCID3112641535 Mechanical  graduates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p><em>Count</em> by program and peer group as described in <a href="data-shaping-03-aggregating-transforms.html#counting">Aggregating transforms</a>. The result is in block-records format.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">key_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"peer_group"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell base">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># base R</span></span>
<span><span class="va">freq_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cohort_df</span><span class="op">$</span><span class="va">program</span>,</span>
<span>                    <span class="va">cohort_df</span><span class="op">$</span><span class="va">peer_group</span>,</span>
<span>                    dnn <span class="op">=</span> <span class="va">key_columns</span><span class="op">)</span></span>
<span><span class="va">blocks_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">freq_table</span>, </span>
<span>                         responseName <span class="op">=</span> <span class="st">"N"</span>,</span>
<span>                         stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell dtbl">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># data.table</span></span>
<span><span class="va">blocks_dt</span> <span class="op">&lt;-</span> <span class="va">cohort_dt</span><span class="op">[</span>, <span class="va">.N</span>, by <span class="op">=</span> <span class="va">key_columns</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/setorder.html">setorder</a></span><span class="op">(</span><span class="va">blocks_dt</span>, <span class="va">program</span>, <span class="op">-</span><span class="va">N</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell dplyr">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dplyr</span></span>
<span><span class="va">blocks_tbl</span> <span class="op">&lt;-</span> <span class="va">cohort_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">program</span>, <span class="va">peer_group</span>, name <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">blocks_dt</span></span>
<span><span class="co">#&gt;        program    peer_group     N</span></span>
<span><span class="co">#&gt;         &lt;char&gt;        &lt;char&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1:      Civil ever_enrolled  1504</span></span>
<span><span class="co">#&gt;  2:      Civil      starters   983</span></span>
<span><span class="co">#&gt;  3:      Civil     graduates   936</span></span>
<span><span class="co">#&gt;  4: Electrical ever_enrolled  1490</span></span>
<span><span class="co">#&gt;  5: Electrical      starters  1080</span></span>
<span><span class="co">#&gt;  6: Electrical     graduates   736</span></span>
<span><span class="co">#&gt;  7: Industrial ever_enrolled   353</span></span>
<span><span class="co">#&gt;  8: Industrial      starters   285</span></span>
<span><span class="co">#&gt;  9: Industrial     graduates   238</span></span>
<span><span class="co">#&gt; 10: Mechanical ever_enrolled  2306</span></span>
<span><span class="co">#&gt; 11: Mechanical      starters  1705</span></span>
<span><span class="co">#&gt; 12: Mechanical     graduates  1354</span></span>
<span></span>
<span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/check_equiv_frames.html">check_equiv_frames</a></span><span class="op">(</span><span class="va">blocks_df</span>, <span class="va">blocks_dt</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/check_equiv_frames.html">check_equiv_frames</a></span><span class="op">(</span><span class="va">blocks_dt</span>, <span class="va">blocks_tbl</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="blocks-to-row-records" class="level2"><h2 class="anchored" data-anchor-id="blocks-to-row-records">Blocks to row-records</h2>
<p>In this transform, we group a set of rows that go together (matching on keys) and combine them into one row by adding columns. The result is in <em>row-records</em> form, with one row per program.</p>
<p><span class="important">Task.</span> Transform the three-cohorts data frame from block-records to row-records format, using <code>program</code> as the primary key.</p>
<div class="cell dtbl">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># data.table</span></span>
<span><span class="va">rowrecs_dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/dcast.data.table.html">dcast</a></span><span class="op">(</span><span class="va">blocks_dt</span>, </span>
<span>                    <span class="va">program</span> <span class="op">~</span> <span class="va">peer_group</span>, </span>
<span>                    value.var <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span>
<span>                    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/setkey.html">setkey</a></span><span class="op">(</span><span class="va">rowrecs_dt</span>, <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell dplyr">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># tidyr</span></span>
<span><span class="va">rowrecs_tbl</span> <span class="op">&lt;-</span> <span class="va">blocks_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="va">program</span>, </span>
<span>              names_from <span class="op">=</span> <span class="va">peer_group</span>, </span>
<span>              values_from <span class="op">=</span> <span class="va">N</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell other">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># cdata</span></span>
<span><span class="va">rowrecs_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://winvector.github.io/cdata//reference/pivot_to_rowrecs.html">pivot_to_rowrecs</a></span><span class="op">(</span><span class="va">blocks_df</span>,  </span>
<span>                               rowKeyColumns <span class="op">=</span> <span class="st">"program"</span>, </span>
<span>                               columnToTakeKeysFrom <span class="op">=</span> <span class="st">"peer_group"</span>,</span>
<span>                               columnToTakeValuesFrom <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rowrecs_dt</span></span>
<span><span class="co">#&gt;       program ever_enrolled graduates starters</span></span>
<span><span class="co">#&gt;        &lt;char&gt;         &lt;int&gt;     &lt;int&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:      Civil          1504       936      983</span></span>
<span><span class="co">#&gt; 2: Electrical          1490       736     1080</span></span>
<span><span class="co">#&gt; 3: Industrial           353       238      285</span></span>
<span><span class="co">#&gt; 4: Mechanical          2306      1354     1705</span></span>
<span></span>
<span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/check_equiv_frames.html">check_equiv_frames</a></span><span class="op">(</span><span class="va">rowrecs_df</span>, <span class="va">rowrecs_dt</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/check_equiv_frames.html">check_equiv_frames</a></span><span class="op">(</span><span class="va">rowrecs_dt</span>, <span class="va">rowrecs_tbl</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="important">Comments</span></p>
<ul>
<li><p>In all cases, the same transformation occurs: column <code>program</code> remains a <em>row key</em> column; the values of the <code>peer_group</code> column (<code>ever_enrolled</code>, <code>graduates</code>, <code>starters</code>) become new key column <em>names</em> with <em>values</em> taken from the <code>N</code> column.</p></li>
<li><p><em>data.table.</em> <code><a href="https://rdatatable.gitlab.io/data.table/reference/dcast.data.table.html">dcast()</a></code> uses a formula <code>LHS ~ RHS</code></p></li>
<li><p><em>tidyr</em> <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code>, an updated approach to <code><a href="https://tidyr.tidyverse.org/reference/spread.html">spread()</a></code>.</p></li>
<li><p><em>cdata.</em> <code><a href="https://winvector.github.io/cdata//reference/pivot_to_rowrecs.html">pivot_to_rowrecs()</a></code>, a special case of the more general function <code><a href="https://winvector.github.io/cdata//reference/blocks_to_rowrecs.html">blocks_to_rowrecs()</a></code>.</p></li>
</ul></section><section id="row-records-to-blocks" class="level2"><h2 class="anchored" data-anchor-id="row-records-to-blocks">Row-records to blocks</h2>
<p>In this transform—the inverse of blocks to row-records—each row is disassembled and used to make a block of many rows. Each block of records in the new data frame has as many rows per record as there are columns we take measurements from.</p>
<p><span class="important">Task.</span> Transform the results from the previous example from row-records to block-records format, using <code>program</code> as the primary key and all other column names collected under a new secondary key column <code>peer_group</code>.</p>
<div class="cell dtbl">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># data.table</span></span>
<span><span class="va">blocks_dt_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html">melt</a></span><span class="op">(</span></span>
<span>  <span class="va">rowrecs_dt</span>, </span>
<span>  measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ever_enrolled"</span>, <span class="st">"graduates"</span>, <span class="st">"starters"</span><span class="op">)</span>, </span>
<span>  variable.name <span class="op">=</span> <span class="st">"peer_group"</span>, </span>
<span>  value.name <span class="op">=</span> <span class="st">"N"</span>, </span>
<span>  variable.factor <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/setorder.html">setorderv</a></span><span class="op">(</span><span class="va">blocks_dt_2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"peer_group"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell dplyr">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># tidyr</span></span>
<span><span class="va">blocks_tbl</span> <span class="op">&lt;-</span> <span class="va">rowrecs_tbl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>  cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ever_enrolled"</span>, <span class="st">"graduates"</span>, <span class="st">"starters"</span><span class="op">)</span>,</span>
<span>  names_to <span class="op">=</span> <span class="st">"peer_group"</span>, </span>
<span>  values_to <span class="op">=</span> <span class="st">"N"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell other">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># cdata</span></span>
<span><span class="va">blocks_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://winvector.github.io/cdata//reference/unpivot_to_blocks.html">unpivot_to_blocks</a></span><span class="op">(</span></span>
<span>  <span class="va">rowrecs_df</span>, </span>
<span>  columnsToTakeFrom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ever_enrolled"</span>, <span class="st">"graduates"</span>, <span class="st">"starters"</span><span class="op">)</span>,</span>
<span>  nameForNewKeyColumn <span class="op">=</span> <span class="st">"peer_group"</span>, </span>
<span>  nameForNewValueColumn <span class="op">=</span> <span class="st">"N"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">blocks_dt_2</span></span>
<span><span class="co">#&gt;        program    peer_group     N</span></span>
<span><span class="co">#&gt;         &lt;char&gt;        &lt;char&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1:      Civil ever_enrolled  1504</span></span>
<span><span class="co">#&gt;  2:      Civil     graduates   936</span></span>
<span><span class="co">#&gt;  3:      Civil      starters   983</span></span>
<span><span class="co">#&gt;  4: Electrical ever_enrolled  1490</span></span>
<span><span class="co">#&gt;  5: Electrical     graduates   736</span></span>
<span><span class="co">#&gt;  6: Electrical      starters  1080</span></span>
<span><span class="co">#&gt;  7: Industrial ever_enrolled   353</span></span>
<span><span class="co">#&gt;  8: Industrial     graduates   238</span></span>
<span><span class="co">#&gt;  9: Industrial      starters   285</span></span>
<span><span class="co">#&gt; 10: Mechanical ever_enrolled  2306</span></span>
<span><span class="co">#&gt; 11: Mechanical     graduates  1354</span></span>
<span><span class="co">#&gt; 12: Mechanical      starters  1705</span></span>
<span></span>
<span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/check_equiv_frames.html">check_equiv_frames</a></span><span class="op">(</span><span class="va">blocks_df</span>, <span class="va">blocks_dt_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/check_equiv_frames.html">check_equiv_frames</a></span><span class="op">(</span><span class="va">blocks_dt_2</span>, <span class="va">blocks_tbl</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="important">Comments</span></p>
<ul>
<li><p>In all cases, the same transformation occurs: column names are identified (<code>ever_enrolled</code>, <code>graduates</code>, <code>starters</code>) and collected in a new key column (<code>peer_group</code>); the values from these columns are collected in a new payload column (<code>N</code>); and column names not selected (<code>program</code>) are treated as keys, copied to each record row in the result.</p></li>
<li><p><em>data.table</em> <code><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html">melt()</a></code></p></li>
<li><p><em>tidyr</em> <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>, an updated approach to <code><a href="https://tidyr.tidyverse.org/reference/gather.html">gather()</a></code></p></li>
<li><p><em>cdata</em> <code><a href="https://winvector.github.io/cdata//reference/unpivot_to_blocks.html">unpivot_to_blocks()</a></code> a special case of the more general function <code><a href="https://winvector.github.io/cdata//reference/rowrecs_to_blocks.html">rowrecs_to_blocks()</a></code>.</p></li>
</ul>
<p>Confirm that the result is equivalent to the original blocks form.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/check_equiv_frames.html">check_equiv_frames</a></span><span class="op">(</span><span class="va">blocks_dt</span>, <span class="va">blocks_dt_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="midfield-data-keys" class="level2"><h2 class="anchored" data-anchor-id="midfield-data-keys">MIDFIELD data keys</h2>
<p>The previous sections have focused our attention on the importance of <em>keys</em>, that is, variables that alone or in combination uniquely identify a row of data. Here we use <code><a href="https://winvector.github.io/wrapr//reference/checkColsFormUniqueKeys.html">wrapr::checkColsFormUniqueKeys()</a></code> to check if rows of data are uniquely addressable by the columns named. For example, for the Table 3 data in row records form, <code>program</code> is such a key:</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/checkColsFormUniqueKeys.html">checkColsFormUniqueKeys</a></span><span class="op">(</span><span class="va">rowrecs_dt</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the Table 4 data in blocks form, two columns are required:</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/checkColsFormUniqueKeys.html">checkColsFormUniqueKeys</a></span><span class="op">(</span><span class="va">blocks_dt</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"program"</span>, <span class="st">"peer_group"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the midfielddata practice data, the keys are:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">student</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/checkColsFormUniqueKeys.html">checkColsFormUniqueKeys</a></span><span class="op">(</span><span class="va">student</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mcid"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/checkColsFormUniqueKeys.html">checkColsFormUniqueKeys</a></span><span class="op">(</span><span class="va">term</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"term"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">course</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/checkColsFormUniqueKeys.html">checkColsFormUniqueKeys</a></span><span class="op">(</span><span class="va">course</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"term_course"</span>, <span class="st">"abbrev"</span>, <span class="st">"number"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">degree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://winvector.github.io/wrapr//reference/checkColsFormUniqueKeys.html">checkColsFormUniqueKeys</a></span><span class="op">(</span><span class="va">degree</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mcid"</span>, <span class="st">"degree"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="next-steps" class="level2"><h2 class="anchored" data-anchor-id="next-steps">Next steps</h2>
<p>Reshaping transforms can also be applied to more than one column, though we don’t cover that use case here. For those interested:</p>
<ul>
<li><p>data.table’s <code><a href="https://rdatatable.gitlab.io/data.table/reference/dcast.data.table.html">dcast()</a></code> allows more complicated transforms, such as casting to multiple variables and aggregations at the same time.</p></li>
<li><p>cdata has simple methods for conversions of many columns at once using <code><a href="https://winvector.github.io/cdata//reference/blocks_to_rowrecs.html">blocks_to_rowrecs()</a></code> and <code>rowrecs_to_blocs()</code> plus a “control table”. See, for example, <a href="https://win-vector.com/2018/10/21/faceted-graphs-with-cdata-and-ggplot2/">Faceted graphs with cdata and ggplot2</a></p></li>
<li><p>tidyr has similar functions, inspired by cdata, using <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer_spec.html">pivot_longer_spec()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider_spec.html">pivot_wider_spec()</a></code>. See <a href="https://tidyr.tidyverse.org/reference/pivot_wider_spec.html">Pivot data from long to wide using a spec</a>.</p></li>
</ul></section><section id="references" class="level2"><h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Mount+Zumel:2019:fluid-data" class="csl-entry" role="listitem">
Mount, J., &amp; Zumel, N. (2019). <em><span class="nocase">Coordinatized data: A fluid data specification</span></em>. <span>Win Vector LLC</span>. <a href="http://winvector.github.io/FluidData/RowsAndColumns.html">http://winvector.github.io/FluidData/RowsAndColumns.html</a>
</div>
<div id="ref-Mount+Zumel:2021:block+row+records" class="csl-entry" role="listitem">
Mount, J., &amp; Zumel, N. (2021). <em><span class="nocase">Block records and row records</span></em>. <span>Win Vector LLC</span>. <a href="https://winvector.github.io/cdata/articles/blocksrecs.html">https://winvector.github.io/cdata/articles/blocksrecs.html</a>
</div>
</div>


</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://utteranc.es/client.js" repo="https://github.com/MIDFIELDR/2024-midfield-institute" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./data-shaping-04-multi-table-transforms.html" class="pagination-link" aria-label="Multi-table transforms">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Multi-table transforms</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./r-resources.html" class="pagination-link" aria-label="Resources">
        <span class="nav-page-text">Resources</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link active" href="./license.html" aria-current="page">
<p>License</p>
</a>
  </li>  
</ul>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/MIDFIELDR/2024-midfield-institute/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>