{
  "hash": "8ec791dec95228bba1ca8af3575c7e19",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Reshaping transforms\"\n---\n\n\n![Image: *SAREC field day 2018* by Univ Wyoming Extension CT is licensed under [CC BY-NC-ND 2.0](https://creativecommons.org/licenses/by-nc-nd/2.0/)](figures/data-shaping-5.png)\n\n\n\n\n::: {.cell}\n\n:::\n\n\nUsing **cdata**, **data.table**, and **dplyr/tidyr** to transform MIDFIELD data as needed for your analysis (no base R transforms in this section). \n\nIn this section, we cover reshaping data frames by moving data between rows and columns, often called *pivoting*. \n\n\n\n\n\n## Terminology \n\nPivoting operations go by a number of different names, as listed in Table 1 [@Mount+Zumel:2019:fluid-data].   \n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"mrdxmhxges\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mrdxmhxges table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mrdxmhxges thead, #mrdxmhxges tbody, #mrdxmhxges tfoot, #mrdxmhxges tr, #mrdxmhxges td, #mrdxmhxges th {\n  border-style: none;\n}\n\n#mrdxmhxges p {\n  margin: 0;\n  padding: 0;\n}\n\n#mrdxmhxges .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: small;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #000000;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mrdxmhxges .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mrdxmhxges .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mrdxmhxges .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mrdxmhxges .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mrdxmhxges .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#mrdxmhxges .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mrdxmhxges .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mrdxmhxges .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mrdxmhxges .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mrdxmhxges .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mrdxmhxges .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mrdxmhxges .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mrdxmhxges .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mrdxmhxges .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  vertical-align: middle;\n}\n\n#mrdxmhxges .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mrdxmhxges .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mrdxmhxges .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: none;\n  border-top-width: 1px;\n  border-top-color: #D5D5D5;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D5D5D5;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D5D5D5;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mrdxmhxges .gt_stub {\n  color: #FFFFFF;\n  background-color: #5F5F5F;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #5F5F5F;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mrdxmhxges .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mrdxmhxges .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mrdxmhxges .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mrdxmhxges .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mrdxmhxges .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #5F5F5F;\n}\n\n#mrdxmhxges .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mrdxmhxges .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#mrdxmhxges .gt_grand_summary_row {\n  color: #333333;\n  background-color: #D5D5D5;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mrdxmhxges .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #5F5F5F;\n}\n\n#mrdxmhxges .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #5F5F5F;\n}\n\n#mrdxmhxges .gt_striped {\n  background-color: #F4F4F4;\n}\n\n#mrdxmhxges .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#mrdxmhxges .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mrdxmhxges .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mrdxmhxges .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mrdxmhxges .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mrdxmhxges .gt_left {\n  text-align: left;\n}\n\n#mrdxmhxges .gt_center {\n  text-align: center;\n}\n\n#mrdxmhxges .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mrdxmhxges .gt_font_normal {\n  font-weight: normal;\n}\n\n#mrdxmhxges .gt_font_bold {\n  font-weight: bold;\n}\n\n#mrdxmhxges .gt_font_italic {\n  font-style: italic;\n}\n\n#mrdxmhxges .gt_super {\n  font-size: 65%;\n}\n\n#mrdxmhxges .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mrdxmhxges .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mrdxmhxges .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mrdxmhxges .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mrdxmhxges .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mrdxmhxges .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mrdxmhxges .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mrdxmhxges .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mrdxmhxges div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Table 1: Reshaping operations</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"System\">System</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pivot &quot;wider&quot;\">Pivot \"wider\"</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pivot &quot;longer&quot;\">Pivot \"longer\"</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"System\" class=\"gt_row gt_left\">colloquially called</td>\n<td headers=\"Pivot \"wider\"\" class=\"gt_row gt_left\">\"tall to wide\"</td>\n<td headers=\"Pivot \"longer\"\" class=\"gt_row gt_left\">\"wide to tall\"</td></tr>\n    <tr><td headers=\"System\" class=\"gt_row gt_left gt_striped\">Microsoft Excel</td>\n<td headers=\"Pivot \"wider\"\" class=\"gt_row gt_left gt_striped\">pivot</td>\n<td headers=\"Pivot \"longer\"\" class=\"gt_row gt_left gt_striped\">un-pivot</td></tr>\n    <tr><td headers=\"System\" class=\"gt_row gt_left\">databases</td>\n<td headers=\"Pivot \"wider\"\" class=\"gt_row gt_left\">pivot</td>\n<td headers=\"Pivot \"longer\"\" class=\"gt_row gt_left\">anti-pivot</td></tr>\n    <tr><td headers=\"System\" class=\"gt_row gt_left gt_striped\">databases</td>\n<td headers=\"Pivot \"wider\"\" class=\"gt_row gt_left gt_striped\">crosstab</td>\n<td headers=\"Pivot \"longer\"\" class=\"gt_row gt_left gt_striped\">shred</td></tr>\n    <tr><td headers=\"System\" class=\"gt_row gt_left\">R</td>\n<td headers=\"Pivot \"wider\"\" class=\"gt_row gt_left\">unstack</td>\n<td headers=\"Pivot \"longer\"\" class=\"gt_row gt_left\">stack</td></tr>\n    <tr><td headers=\"System\" class=\"gt_row gt_left gt_striped\">reshape, reshape2</td>\n<td headers=\"Pivot \"wider\"\" class=\"gt_row gt_left gt_striped\">cast</td>\n<td headers=\"Pivot \"longer\"\" class=\"gt_row gt_left gt_striped\">melt</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n<br>\n\nPivoting is possible in base R but the package versions in data.table,  tidyr, and cdata are significantly better tools. Table 2 lists the reshaping functions we use in this work. \n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"divzblgjcj\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#divzblgjcj table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#divzblgjcj thead, #divzblgjcj tbody, #divzblgjcj tfoot, #divzblgjcj tr, #divzblgjcj td, #divzblgjcj th {\n  border-style: none;\n}\n\n#divzblgjcj p {\n  margin: 0;\n  padding: 0;\n}\n\n#divzblgjcj .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: small;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #000000;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#divzblgjcj .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#divzblgjcj .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#divzblgjcj .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#divzblgjcj .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#divzblgjcj .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#divzblgjcj .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#divzblgjcj .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#divzblgjcj .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#divzblgjcj .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#divzblgjcj .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#divzblgjcj .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#divzblgjcj .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#divzblgjcj .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#divzblgjcj .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  vertical-align: middle;\n}\n\n#divzblgjcj .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#divzblgjcj .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#divzblgjcj .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: none;\n  border-top-width: 1px;\n  border-top-color: #D5D5D5;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D5D5D5;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D5D5D5;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#divzblgjcj .gt_stub {\n  color: #FFFFFF;\n  background-color: #5F5F5F;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #5F5F5F;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#divzblgjcj .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#divzblgjcj .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#divzblgjcj .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#divzblgjcj .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#divzblgjcj .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #5F5F5F;\n}\n\n#divzblgjcj .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#divzblgjcj .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#divzblgjcj .gt_grand_summary_row {\n  color: #333333;\n  background-color: #D5D5D5;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#divzblgjcj .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #5F5F5F;\n}\n\n#divzblgjcj .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #5F5F5F;\n}\n\n#divzblgjcj .gt_striped {\n  background-color: #F4F4F4;\n}\n\n#divzblgjcj .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#divzblgjcj .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#divzblgjcj .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#divzblgjcj .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#divzblgjcj .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#divzblgjcj .gt_left {\n  text-align: left;\n}\n\n#divzblgjcj .gt_center {\n  text-align: center;\n}\n\n#divzblgjcj .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#divzblgjcj .gt_font_normal {\n  font-weight: normal;\n}\n\n#divzblgjcj .gt_font_bold {\n  font-weight: bold;\n}\n\n#divzblgjcj .gt_font_italic {\n  font-style: italic;\n}\n\n#divzblgjcj .gt_super {\n  font-size: 65%;\n}\n\n#divzblgjcj .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#divzblgjcj .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#divzblgjcj .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#divzblgjcj .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#divzblgjcj .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#divzblgjcj .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#divzblgjcj .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#divzblgjcj .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#divzblgjcj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Table 2: Reshaping functions we use</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"R package\">R package</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pivot &quot;wider&quot;\">Pivot \"wider\"</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Pivot &quot;longer&quot;\">Pivot \"longer\"</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"R package\" class=\"gt_row gt_left\">data.table</td>\n<td headers=\"Pivot \"wider\"\" class=\"gt_row gt_left\">dcast()</td>\n<td headers=\"Pivot \"longer\"\" class=\"gt_row gt_left\">melt()</td></tr>\n    <tr><td headers=\"R package\" class=\"gt_row gt_left gt_striped\">tidyr</td>\n<td headers=\"Pivot \"wider\"\" class=\"gt_row gt_left gt_striped\">pivot_wider()</td>\n<td headers=\"Pivot \"longer\"\" class=\"gt_row gt_left gt_striped\">pivot_longer()</td></tr>\n    <tr><td headers=\"R package\" class=\"gt_row gt_left\">cdata</td>\n<td headers=\"Pivot \"wider\"\" class=\"gt_row gt_left\">pivot_to_rowrecs()</td>\n<td headers=\"Pivot \"longer\"\" class=\"gt_row gt_left\">unpivot_to_blocks()</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n<br>\n\nThe data set we use in this section is shown in Table 3, where \"starters\" is the number of students starting in an engineering program, \"ever enrolled\" is the number who were enrolled at least one term in the program, and \"graduates\" is the number graduating from that program. \n\n\n::: {.cell .no-stripe}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ewsvqrtezy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ewsvqrtezy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ewsvqrtezy thead, #ewsvqrtezy tbody, #ewsvqrtezy tfoot, #ewsvqrtezy tr, #ewsvqrtezy td, #ewsvqrtezy th {\n  border-style: none;\n}\n\n#ewsvqrtezy p {\n  margin: 0;\n  padding: 0;\n}\n\n#ewsvqrtezy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: small;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #000000;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ewsvqrtezy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ewsvqrtezy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ewsvqrtezy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ewsvqrtezy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ewsvqrtezy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#ewsvqrtezy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ewsvqrtezy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ewsvqrtezy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ewsvqrtezy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ewsvqrtezy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ewsvqrtezy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ewsvqrtezy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ewsvqrtezy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ewsvqrtezy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  vertical-align: middle;\n}\n\n#ewsvqrtezy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ewsvqrtezy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ewsvqrtezy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: none;\n  border-top-width: 1px;\n  border-top-color: #D5D5D5;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D5D5D5;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D5D5D5;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ewsvqrtezy .gt_stub {\n  color: #FFFFFF;\n  background-color: #5F5F5F;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #5F5F5F;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ewsvqrtezy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ewsvqrtezy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ewsvqrtezy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ewsvqrtezy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ewsvqrtezy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #5F5F5F;\n}\n\n#ewsvqrtezy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ewsvqrtezy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#ewsvqrtezy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #D5D5D5;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ewsvqrtezy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #5F5F5F;\n}\n\n#ewsvqrtezy .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #5F5F5F;\n}\n\n#ewsvqrtezy .gt_striped {\n  background-color: #F4F4F4;\n}\n\n#ewsvqrtezy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#ewsvqrtezy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ewsvqrtezy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ewsvqrtezy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ewsvqrtezy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ewsvqrtezy .gt_left {\n  text-align: left;\n}\n\n#ewsvqrtezy .gt_center {\n  text-align: center;\n}\n\n#ewsvqrtezy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ewsvqrtezy .gt_font_normal {\n  font-weight: normal;\n}\n\n#ewsvqrtezy .gt_font_bold {\n  font-weight: bold;\n}\n\n#ewsvqrtezy .gt_font_italic {\n  font-style: italic;\n}\n\n#ewsvqrtezy .gt_super {\n  font-size: 65%;\n}\n\n#ewsvqrtezy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ewsvqrtezy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ewsvqrtezy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ewsvqrtezy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ewsvqrtezy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ewsvqrtezy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ewsvqrtezy .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ewsvqrtezy .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ewsvqrtezy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Table 3. Row-records form</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"background-color: #D8DAEB;\" scope=\"col\" id=\"program\">program</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"background-color: #80CDC1;\" scope=\"col\" id=\"starters\">starters</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"background-color: #DFC27D;\" scope=\"col\" id=\"ever_enrolled\">ever_enrolled</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"background-color: #C2A5CF;\" scope=\"col\" id=\"graduates\">graduates</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"program\" class=\"gt_row gt_left\" style=\"background-color: #D9D9D9;\">Civil</td>\n<td headers=\"starters\" class=\"gt_row gt_right\" style=\"background-color: #C7EAE5;\">983</td>\n<td headers=\"ever_enrolled\" class=\"gt_row gt_right\" style=\"background-color: #F6E8C3;\">1504</td>\n<td headers=\"graduates\" class=\"gt_row gt_right\" style=\"background-color: #E7D4E8;\">936</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #D9D9D9;\">Electrical</td>\n<td headers=\"starters\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #C7EAE5;\">1080</td>\n<td headers=\"ever_enrolled\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F6E8C3;\">1490</td>\n<td headers=\"graduates\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #E7D4E8;\">736</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left\" style=\"background-color: #D9D9D9;\">Industrial</td>\n<td headers=\"starters\" class=\"gt_row gt_right\" style=\"background-color: #C7EAE5;\">285</td>\n<td headers=\"ever_enrolled\" class=\"gt_row gt_right\" style=\"background-color: #F6E8C3;\">353</td>\n<td headers=\"graduates\" class=\"gt_row gt_right\" style=\"background-color: #E7D4E8;\">238</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #D9D9D9;\">Mechanical</td>\n<td headers=\"starters\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #C7EAE5;\">1705</td>\n<td headers=\"ever_enrolled\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F6E8C3;\">2306</td>\n<td headers=\"graduates\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #E7D4E8;\">1354</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n<br>\n\nThese data are in \"wide\" format, with one row per program. In this form, the \"coordinates\" of a measurement (a count of students) are the value of the primary key (`program`) and a column name.^[We refer again to Mount & Zumel  (2019) for the concept of *coordinatized data*.]\n\nIn Table 4, these data are transformed to \"tall\" format, with three rows per program. As indicated by the cell color-coding,  the names of three columns in Table 3 are now values in the peer-group column in Table 4 and all counts of students are collected in the N column. In this form, the coordinates of a measurement (`N`) are given by the composite key (`program` + `peer_group`). \n \n\n::: {.cell .no-stripe}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"dvamaqkcdv\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#dvamaqkcdv table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#dvamaqkcdv thead, #dvamaqkcdv tbody, #dvamaqkcdv tfoot, #dvamaqkcdv tr, #dvamaqkcdv td, #dvamaqkcdv th {\n  border-style: none;\n}\n\n#dvamaqkcdv p {\n  margin: 0;\n  padding: 0;\n}\n\n#dvamaqkcdv .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: small;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #000000;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#dvamaqkcdv .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#dvamaqkcdv .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#dvamaqkcdv .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#dvamaqkcdv .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dvamaqkcdv .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#dvamaqkcdv .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dvamaqkcdv .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#dvamaqkcdv .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#dvamaqkcdv .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#dvamaqkcdv .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#dvamaqkcdv .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#dvamaqkcdv .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#dvamaqkcdv .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#dvamaqkcdv .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n  vertical-align: middle;\n}\n\n#dvamaqkcdv .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#dvamaqkcdv .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#dvamaqkcdv .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: none;\n  border-top-width: 1px;\n  border-top-color: #D5D5D5;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D5D5D5;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D5D5D5;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#dvamaqkcdv .gt_stub {\n  color: #FFFFFF;\n  background-color: #5F5F5F;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #5F5F5F;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dvamaqkcdv .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#dvamaqkcdv .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#dvamaqkcdv .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#dvamaqkcdv .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dvamaqkcdv .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #5F5F5F;\n}\n\n#dvamaqkcdv .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#dvamaqkcdv .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#dvamaqkcdv .gt_grand_summary_row {\n  color: #333333;\n  background-color: #D5D5D5;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dvamaqkcdv .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #5F5F5F;\n}\n\n#dvamaqkcdv .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #5F5F5F;\n}\n\n#dvamaqkcdv .gt_striped {\n  background-color: #F4F4F4;\n}\n\n#dvamaqkcdv .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #5F5F5F;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #5F5F5F;\n}\n\n#dvamaqkcdv .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dvamaqkcdv .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dvamaqkcdv .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dvamaqkcdv .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dvamaqkcdv .gt_left {\n  text-align: left;\n}\n\n#dvamaqkcdv .gt_center {\n  text-align: center;\n}\n\n#dvamaqkcdv .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#dvamaqkcdv .gt_font_normal {\n  font-weight: normal;\n}\n\n#dvamaqkcdv .gt_font_bold {\n  font-weight: bold;\n}\n\n#dvamaqkcdv .gt_font_italic {\n  font-style: italic;\n}\n\n#dvamaqkcdv .gt_super {\n  font-size: 65%;\n}\n\n#dvamaqkcdv .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#dvamaqkcdv .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#dvamaqkcdv .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#dvamaqkcdv .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#dvamaqkcdv .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#dvamaqkcdv .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#dvamaqkcdv .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#dvamaqkcdv .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#dvamaqkcdv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption>Table 4. Blocks form</caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"background-color: #D8DAEB;\" scope=\"col\" id=\"program\">program</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"text-align: left; background-color: #D8DAEB;\" scope=\"col\" id=\"peer_group\">peer_group</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"background-color: #D8DAEB;\" scope=\"col\" id=\"N\">N</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"program\" class=\"gt_row gt_left\" style=\"background-color: #D9D9D9;\">Civil</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center\" style=\"text-align: left; background-color: #80CDC1;\">starters</td>\n<td headers=\"N\" class=\"gt_row gt_right\" style=\"background-color: #C7EAE5;\">983</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #D9D9D9;\">Electrical</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center gt_striped\" style=\"text-align: left; background-color: #80CDC1;\">starters</td>\n<td headers=\"N\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #C7EAE5;\">1080</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left\" style=\"background-color: #D9D9D9;\">Industrial</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center\" style=\"text-align: left; background-color: #80CDC1;\">starters</td>\n<td headers=\"N\" class=\"gt_row gt_right\" style=\"background-color: #C7EAE5;\">285</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #D9D9D9; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;\">Mechanical</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center gt_striped\" style=\"text-align: left; background-color: #80CDC1; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;\">starters</td>\n<td headers=\"N\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #C7EAE5; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;\">1705</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left\" style=\"background-color: #D9D9D9;\">Civil</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center\" style=\"text-align: left; background-color: #DFC27D;\">ever_enrolled</td>\n<td headers=\"N\" class=\"gt_row gt_right\" style=\"background-color: #F6E8C3;\">1504</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #D9D9D9;\">Electrical</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center gt_striped\" style=\"text-align: left; background-color: #DFC27D;\">ever_enrolled</td>\n<td headers=\"N\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F6E8C3;\">1490</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left\" style=\"background-color: #D9D9D9;\">Industrial</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center\" style=\"text-align: left; background-color: #DFC27D;\">ever_enrolled</td>\n<td headers=\"N\" class=\"gt_row gt_right\" style=\"background-color: #F6E8C3;\">353</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #D9D9D9; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;\">Mechanical</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center gt_striped\" style=\"text-align: left; background-color: #DFC27D; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;\">ever_enrolled</td>\n<td headers=\"N\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #F6E8C3; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;\">2306</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left\" style=\"background-color: #D9D9D9;\">Civil</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center\" style=\"text-align: left; background-color: #C2A5CF;\">graduates</td>\n<td headers=\"N\" class=\"gt_row gt_right\" style=\"background-color: #E7D4E8;\">936</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #D9D9D9;\">Electrical</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center gt_striped\" style=\"text-align: left; background-color: #C2A5CF;\">graduates</td>\n<td headers=\"N\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #E7D4E8;\">736</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left\" style=\"background-color: #D9D9D9;\">Industrial</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center\" style=\"text-align: left; background-color: #C2A5CF;\">graduates</td>\n<td headers=\"N\" class=\"gt_row gt_right\" style=\"background-color: #E7D4E8;\">238</td></tr>\n    <tr><td headers=\"program\" class=\"gt_row gt_left gt_striped\" style=\"background-color: #D9D9D9; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;\">Mechanical</td>\n<td headers=\"peer_group\" class=\"gt_row gt_center gt_striped\" style=\"text-align: left; background-color: #C2A5CF; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;\">graduates</td>\n<td headers=\"N\" class=\"gt_row gt_right gt_striped\" style=\"background-color: #E7D4E8; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: #969696;\">1354</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n<br>\n \nYou can see why \"wide\" and  \"tall\" are commonly used to describe these two formats.  Yet \"wider\" implies having more columns, and (while true here) that is not always the case. \n\nWhat *is* always true is that the first format comprises ***row records***, or one row per primary key, and the second format comprises ***blocks***, or multiple rows per primary key [@Mount+Zumel:2021:block+row+records]. As long as the data are properly \"coordinatized\", the transformations are invertible.\n\nIn our opinion, *blocks* and *row records* describe these data formats more memorably than the alternatives, so we use them to define our transforms as well: \n\n- *blocks to row-records* (i.e., pivoting or \"tall to wide\")\n\n- *row-records to blocks* (i.e., un-pivoting or \"wide to tall\")\n\n\n\n\n\n\n\n## Why transform?\n\nWe transform data between blocks and row records to meet specific needs. Most data processing steps, for example, have a preferred format for how data is arranged in rows and columns. Some packages, like [ggplot2](https://CRAN.R-project.org/package=ggplot2), require blocks; others, like the [likert](https://CRAN.R-project.org/package=likert) package, require row records if the survey data is in summary form (frequencies counted) but requires blocks if not summarized, i.e., one row per respondent, one column per question.\n\nRow records are generally preferred for publishing a data table such as Table 3 and they support analytical tasks as well. For example, the academic program metric \"stickiness\" is the ratio of the number of graduates from a program to the number ever enrolled in the program. With a data frame `df` organized like the Table 3 data, computing stickiness requires one line of code operating on values in the same row, e.g., \n\n```r\n# base R\ndf$stickiness <- df$graduates / df$ever_enrolled\n```\n\nBlocks, on the other hand, are convenient for grouping and summarizing operations and, as stated earlier, are required for making charts with ggplot2. For example, with a data frame `blocks` organized like the Table 4 data, the three column names are variables used as arguments in the `aes()` function that appear in the chart on the horizontal scale (N), the vertical scale (programs), and the legend (peer groups). \n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(blocks, aes(x = N, \n                   y = program, \n                   color = peer_group, \n                   shape = peer_group)) +\n  geom_point(size = 3) +\n  theme_light()\n```\n\n::: {.cell-output-display}\n![](data-shaping-05-reshaping-transforms_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n## Setup \n\n*Load* packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"midfielddata\")\nlibrary(\"data.table\")\nlibrary(\"dplyr\", warn.conflicts = FALSE)\nlibrary(\"tidyr\")\nlibrary(\"wrapr\")\nlibrary(\"cdata\")\n```\n:::\n\n\n*Format* data as described in the  [Introduction](data-shaping-00-introduction.html).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncohort <- fread(\"data/three_blocs.csv\")\n```\n:::\n\n::: {.cell class='base'}\n\n```{.r .cell-code}\n# base R\ncohort_df <- data.frame(cohort)\n```\n:::\n\n::: {.cell class='dtbl'}\n\n```{.r .cell-code}\n# data.table\ncohort_dt <- copy(cohort)\n```\n:::\n\n::: {.cell class='dplyr'}\n\n```{.r .cell-code}\n# dplyr\ncohort_tbl <- tibble(cohort)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncohort_dt\n#>                  mcid    program peer_group\n#>                <char>     <char>     <char>\n#>     1: MCID3111142965 Electrical   starters\n#>     2: MCID3111145102 Electrical   starters\n#>     3: MCID3111150194 Industrial   starters\n#>     4: MCID3111156083 Electrical   starters\n#>     5: MCID3111156325 Electrical   starters\n#>    ---                                     \n#> 12966: MCID3112618553 Mechanical  graduates\n#> 12967: MCID3112618574 Mechanical  graduates\n#> 12968: MCID3112618976 Mechanical  graduates\n#> 12969: MCID3112619484 Electrical  graduates\n#> 12970: MCID3112641535 Mechanical  graduates\n```\n:::\n\n\n<br>\n\n*Count* by program and peer group as described in [Aggregating transforms](data-shaping-03-aggregating-transforms.html#counting). The result is in block-records format. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkey_columns <- c(\"program\", \"peer_group\") \n```\n:::\n\n::: {.cell class='base'}\n\n```{.r .cell-code}\n# base R\nfreq_table <- table(cohort_df$program,\n                    cohort_df$peer_group,\n                    dnn = key_columns)\nblocks_df <- as.data.frame(freq_table, \n                         responseName = \"N\",\n                         stringsAsFactors = FALSE)\n```\n:::\n\n::: {.cell class='dtbl'}\n\n```{.r .cell-code}\n# data.table\nblocks_dt <- cohort_dt[, .N, by = key_columns]\nsetorder(blocks_dt, program, -N)\n```\n:::\n\n::: {.cell class='dplyr'}\n\n```{.r .cell-code}\n# dplyr\nblocks_tbl <- cohort_tbl %>%\n count(program, peer_group, name = \"N\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nblocks_dt\n#>        program    peer_group     N\n#>         <char>        <char> <int>\n#>  1:      Civil ever_enrolled  1504\n#>  2:      Civil      starters   983\n#>  3:      Civil     graduates   936\n#>  4: Electrical ever_enrolled  1490\n#>  5: Electrical      starters  1080\n#>  6: Electrical     graduates   736\n#>  7: Industrial ever_enrolled   353\n#>  8: Industrial      starters   285\n#>  9: Industrial     graduates   238\n#> 10: Mechanical ever_enrolled  2306\n#> 11: Mechanical      starters  1705\n#> 12: Mechanical     graduates  1354\n\ncheck_equiv_frames(blocks_df, blocks_dt)\n#> [1] TRUE\ncheck_equiv_frames(blocks_dt, blocks_tbl)\n#> [1] TRUE\n```\n:::\n\n\n\n\n\n\n\n## Blocks to row-records\n\nIn this transform, we group a set of rows that go together (matching on keys) and combine them into one row by adding columns. The result is in *row-records* form, with one row per program. \n\n[Task.]{.important} Transform the three-cohorts data frame from block-records to row-records format, using `program` as the primary key.  \n\n\n::: {.cell class='dtbl'}\n\n```{.r .cell-code}\n# data.table\nrowrecs_dt <- dcast(blocks_dt, \n                    program ~ peer_group, \n                    value.var = \"N\")\n                    setkey(rowrecs_dt, NULL)\n```\n:::\n\n::: {.cell class='dplyr'}\n\n```{.r .cell-code}\n# tidyr\nrowrecs_tbl <- blocks_tbl %>%\n  pivot_wider(id_cols = program, \n              names_from = peer_group, \n              values_from = N)\n```\n:::\n\n::: {.cell class='other'}\n\n```{.r .cell-code}\n# cdata\nrowrecs_df <- pivot_to_rowrecs(blocks_df,  \n                               rowKeyColumns = \"program\", \n                               columnToTakeKeysFrom = \"peer_group\",\n                               columnToTakeValuesFrom = \"N\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrowrecs_dt\n#>       program ever_enrolled graduates starters\n#>        <char>         <int>     <int>    <int>\n#> 1:      Civil          1504       936      983\n#> 2: Electrical          1490       736     1080\n#> 3: Industrial           353       238      285\n#> 4: Mechanical          2306      1354     1705\n\ncheck_equiv_frames(rowrecs_df, rowrecs_dt)\n#> [1] TRUE\ncheck_equiv_frames(rowrecs_dt, rowrecs_tbl)\n#> [1] TRUE\n```\n:::\n\n\n[Comments]{.important} \n\n- In all cases, the same transformation occurs: column `program` remains a *row key* column; the values of the `peer_group` column (`ever_enrolled`, `graduates`, `starters`) become new key column *names* with *values* taken from the `N` column. \n\n- *data.table.* `dcast()` uses a formula `LHS ~ RHS`\n\n- *tidyr* `pivot_wider()`, an updated approach to `spread()`. \n\n- *cdata.* `pivot_to_rowrecs()`, a special case of the more general function `blocks_to_rowrecs()`.\n\n\n\n\n\n\n## Row-records to blocks\n\nIn this transform---the inverse of  blocks to row-records---each row is disassembled and used to make a block of many rows. Each block of records in the new data frame has as many rows per record as there are columns we take measurements from. \n\n[Task.]{.important} Transform the results from the previous example  from row-records to block-records format, using `program` as the primary key and all other column names collected under a new secondary key column `peer_group`. \n\n\n::: {.cell class='dtbl'}\n\n```{.r .cell-code}\n# data.table\nblocks_dt_2 <- melt(\n  rowrecs_dt, \n  measure.vars = c(\"ever_enrolled\", \"graduates\", \"starters\"), \n  variable.name = \"peer_group\", \n  value.name = \"N\", \n  variable.factor = FALSE\n)\nsetorderv(blocks_dt_2, c(\"program\", \"peer_group\"))\n```\n:::\n\n::: {.cell class='dplyr'}\n\n```{.r .cell-code}\n# tidyr\nblocks_tbl <- rowrecs_tbl %>%\n  pivot_longer(\n  cols = c(\"ever_enrolled\", \"graduates\", \"starters\"),\n  names_to = \"peer_group\", \n  values_to = \"N\"\n)\n```\n:::\n\n::: {.cell class='other'}\n\n```{.r .cell-code}\n# cdata\nblocks_df <- unpivot_to_blocks(\n  rowrecs_df, \n  columnsToTakeFrom = c(\"ever_enrolled\", \"graduates\", \"starters\"),\n  nameForNewKeyColumn = \"peer_group\", \n  nameForNewValueColumn = \"N\"\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nblocks_dt_2\n#>        program    peer_group     N\n#>         <char>        <char> <int>\n#>  1:      Civil ever_enrolled  1504\n#>  2:      Civil     graduates   936\n#>  3:      Civil      starters   983\n#>  4: Electrical ever_enrolled  1490\n#>  5: Electrical     graduates   736\n#>  6: Electrical      starters  1080\n#>  7: Industrial ever_enrolled   353\n#>  8: Industrial     graduates   238\n#>  9: Industrial      starters   285\n#> 10: Mechanical ever_enrolled  2306\n#> 11: Mechanical     graduates  1354\n#> 12: Mechanical      starters  1705\n\ncheck_equiv_frames(blocks_df, blocks_dt_2)\n#> [1] TRUE\ncheck_equiv_frames(blocks_dt_2, blocks_tbl)\n#> [1] TRUE\n```\n:::\n\n\n[Comments]{.important} \n\n- In all cases, the same transformation occurs: column names are identified (`ever_enrolled`, `graduates`, `starters`) and collected in a new key column (`peer_group`); the values from these columns are collected in a new payload column (`N`); and column names not selected (`program`) are treated as keys, copied to each record row in the result.\n\n- *data.table* `melt()`\n\n- *tidyr* `pivot_longer()`, an updated approach to `gather()`\n\n- *cdata* `unpivot_to_blocks()` a special case of the more general function `rowrecs_to_blocks()`. \n\nConfirm that the result is equivalent to the original blocks form. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_equiv_frames(blocks_dt, blocks_dt_2)\n#> [1] TRUE\n```\n:::\n\n\n\n\n\n\n\n## MIDFIELD data keys\n\nThe previous sections have focused our attention on the importance of *keys*, that is, variables that alone or in combination uniquely identify a row of data. \nHere we use  `wrapr::checkColsFormUniqueKeys()` to check if rows of data are uniquely addressable by the columns named. For example, for the Table 3 data in row records form, `program` is such a key:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheckColsFormUniqueKeys(rowrecs_dt, c(\"program\"))\n#> [1] TRUE\n```\n:::\n\n\nFor the Table 4 data in blocks form, two columns are required:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheckColsFormUniqueKeys(blocks_dt, c(\"program\", \"peer_group\"))\n#> [1] TRUE\n```\n:::\n\n\nFor the midfielddata practice data, the keys are:\n\n```r\ndata(student)\ncheckColsFormUniqueKeys(student, c(\"mcid\"))\n#> [1] TRUE\n\ndata(term)\ncheckColsFormUniqueKeys(term, c(\"mcid\", \"term\"))\n#> [1] TRUE\n\ndata(course)\ncheckColsFormUniqueKeys(course, c(\"mcid\", \"term_course\", \"abbrev\", \"number\"))\n#> [1] TRUE\n\ndata(degree)\ncheckColsFormUniqueKeys(degree, c(\"mcid\", \"degree\"))\n#> [1] TRUE\n```\n\n\n\n\n\n\n## Next steps\n\nReshaping transforms can also be applied to more than one column, though we don't cover that use case here. For those interested:  \n\n- data.table's `dcast()` allows more complicated transforms, such as casting to multiple variables and aggregations at the same time.\n\n- cdata has simple methods for conversions of many columns at once using `blocks_to_rowrecs()` and `rowrecs_to_blocs()` plus a \"control table\".  See, for example, [Faceted graphs with cdata and ggplot2](https://win-vector.com/2018/10/21/faceted-graphs-with-cdata-and-ggplot2/)\n\n- tidyr has similar functions, inspired by cdata, using `pivot_longer_spec()` and `pivot_wider_spec()`. See [Pivot data from long to wide using a spec](https://tidyr.tidyverse.org/reference/pivot_wider_spec.html). \n\n\n\n\n\n\n\n\n\n## References \n\n<div id=\"refs\"></div>\n\n",
    "supporting": [
      "data-shaping-05-reshaping-transforms_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}