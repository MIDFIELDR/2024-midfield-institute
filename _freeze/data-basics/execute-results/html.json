{
  "hash": "cab539578cb6f7f3a5a3e189e366bb79",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"R data basics\"\nnocite: |\n  @R-data.table\n---\n\n\n![Image: *US Route 60 Large Array* by Mobilus In Mobili is licensed under [CC BY-SA 2.0](https://creativecommons.org/licenses/by-sa/2.0/legalcode)](figures/data-basics.png)\n\n\n\n\n\nUsing data.table to manipulate data in R. \n\n*License.* &nbsp; This material is adapted from *Getting started in R: Tinyverse edition* by Bashir and Eddelbuettel [-@Bashir+Eddelbuettel:2018] which was licensed under CC BY-SA by [ilustat](https://ilustat.com/post/writing-real-life-motivated-r-guides/). This adaptation and extension, *R data basics* by Richard Layton, is licensed under [CC BY-SA 2.0](https://creativecommons.org/licenses/by-sa/2.0/legalcode). \n\n## Preface\n\nMIDFIELD data are curated, that is, organized and integrated from multiple institutions, maintained over time, and available for reuse and preservation. Yet to address any specific research question, the data must be wrangled into a shape useful for analysis.\n\n> The basic concept of data wrangling is to visualize your data being structured to make your task easier, and then take the steps to add this structure to your data  [@Zumel+Mount:2020, p.113.]. \n\nThis tutorial covers basic operations for data shaping with the goal of obtaining a simple \"data matrix\" where each row is an observation and each column is a measurement type.\n\n \n\n\n\n*Using data.table.* &nbsp; The rationale for manipulating data using the data.table package instead of base R or the dplyr package include speed, memory efficiency, and concise transforms via the []-indexing operator (e.g., the \"by\" grouping notation). \n\nTo mitigate the extra cognitive load for new R users of learning data.table syntax while also learning R, I use a \"no-frills\" approach as much as possible. \n\nConceptually, data.table operations can be viewed as \n\n        dt[i, j, by]\n\nwith some intentional similarity to SQL. Here `i` operates on rows, `j` operates on columns, and `by` is the grouping operator.\n\n\n*Before starting.* &nbsp; Our tutorials assume that you\n\n- Have completed the [Before you arrive](before-you-arrive.html) instructions\n- Have completed the [R basics](r-basics.html) guide \n- Have completed the [R chart basics](chart-basics.html) guide \n- Start your R session by launching the RStudio project you created, e.g., `midfield-institute-2024.Rproj`\n\nIf you are in an RStudio project, the project name appears in the upper left corner of the RStudio window. Your project directory (folder) should look something like this:\n\n    midfield-institute-2024\\\n        data\\\n        results\\\n        scripts\\\n        midfield-institute-2024.Rproj\n\n## Getting started \n\n*Start a new script.* &nbsp; I recommend that you start a new script for this segment. \n\n- Use *File &gt; New File &gt; R Script* to create a new R script\n- *File &gt; Save As...* to name the file (we suggest `03-data-basics.R`), then save it to the `scripts` directory \n- At the top of the script, add a minimal header, something like: \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# R data basics\n# your name  \n# date \n```\n:::\n\n\n- Use `library()` to load packages used in the script. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# silently load packages\nsuppressPackageStartupMessages(library(\"data.table\"))\n\n# set data.table printout options\noptions(\n  datatable.print.nrows = 20,\n  datatable.print.topn = 5,\n  datatable.print.class = TRUE\n)\n```\n:::\n\n\n\nReminder: In a code chunk like the one above, you can click on the \"Copy to clipboard\" icon in the upper right corner to enable quick copy and paste from this document to your script.\n\nUse your script throughout the tutorial. When a new chunk of code is given,  \n\n- Copy the line(s) of code into your script, save, and run.     \n- Check your result by comparing it to the result in the tutorial.\n- Check what you've learned using the **Your turn** exercises.  \n\n## Import data\n\nRead the same data file we used in the previous tutorial. The data set is in block-record (or \"data matrix\") form, that is, variables are columns and observations are rows. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# import data\ncw <- fread(\"data/chick_weight.csv\")\n\n# view\ncw\n#>      Chick  Diet  Time weight\n#>      <int> <int> <int>  <int>\n#>   1:    18     1     0     39\n#>   2:    18     1     2     35\n#>   3:    16     1     0     41\n#>   4:    16     1     2     45\n#>   5:    16     1     4     49\n#>  ---                         \n#> 574:    48     4    14    170\n#> 575:    48     4    16    222\n#> 576:    48     4    18    261\n#> 577:    48     4    20    303\n#> 578:    48     4    21    322\n```\n:::\n\n\n\n## Changes in place\n\n*Rename variables.* &nbsp;  Edit column names \"in place.\" \n\nBy *in place* we mean that the change is made using data.table *reference semantics* (or *by reference*) in which changes are made without assigning the result back to a name, that is, we write\n\n        setnames(cw, old, new)\n\nnot\n\n        cw <- setnames(cw, old, new)\n\n\nFor example, changing the variable names in the `cw` data frame,  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# change column names in place\nsetnames(cw, \n         old = c(\"Chick\", \"Diet\", \"Time\", \"weight\"), \n         new = c(\"chick_id\", \"group\", \"day\", \"weight_g\"))\n\ncw\n#>      chick_id group   day weight_g\n#>         <int> <int> <int>    <int>\n#>   1:       18     1     0       39\n#>   2:       18     1     2       35\n#>   3:       16     1     0       41\n#>   4:       16     1     2       45\n#>   5:       16     1     4       49\n#>  ---                              \n#> 574:       48     4    14      170\n#> 575:       48     4    16      222\n#> 576:       48     4    18      261\n#> 577:       48     4    20      303\n#> 578:       48     4    21      322\n```\n:::\n\n\nThere's much more to reference semantics than dropping the assignment operator---it's really about speed and memory efficiency with large data sets. However, for our \"basics\" series, you need to recall only that the `:=` operator and all data.table functions with names starting with `set` work by reference. \n\n\n::: panel-tabset\n\n## [Exercise 3.1]{.important} \n\n- Create a copy of `cw` using `x <- copy(cw)`\n- In `x`, rename the ID variable to `ID`. \n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- copy(cw)\nsetnames(x, old = c(\"chick_id\"), new = c(\"ID\"))\nx\n#>         ID group   day weight_g\n#>      <int> <int> <int>    <int>\n#>   1:    18     1     0       39\n#>   2:    18     1     2       35\n#>   3:    16     1     0       41\n#>   4:    16     1     2       45\n#>   5:    16     1     4       49\n#>  ---                           \n#> 574:    48     4    14      170\n#> 575:    48     4    16      222\n#> 576:    48     4    18      261\n#> 577:    48     4    20      303\n#> 578:    48     4    21      322\n```\n:::\n\n:::\n\n\n\n\n\n*Reorder variables.* &nbsp; Another example of an operation in-place. The columns listed are moved to the left-hand side of the data frame and other columns appear to the right in their original order. Here we move `day`and `group` to the first two column positions. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# reorder column positions in place\nsetcolorder(cw, c(\"day\", \"group\"))\n\n# view\ncw\n#>        day group chick_id weight_g\n#>      <int> <int>    <int>    <int>\n#>   1:     0     1       18       39\n#>   2:     2     1       18       35\n#>   3:     0     1       16       41\n#>   4:     2     1       16       45\n#>   5:     4     1       16       49\n#>  ---                              \n#> 574:    14     4       48      170\n#> 575:    16     4       48      222\n#> 576:    18     4       48      261\n#> 577:    20     4       48      303\n#> 578:    21     4       48      322\n```\n:::\n\n\nIf you want to make a change without affecting the source data frame, assign a copy of the data frame to a new name with the `copy()` function. Assignment to a new name is not enough; you have to deliberately use the `copy()` function. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create an new object in memory\nx <- copy(cw)\n\n# edit in place\nsetcolorder(x, c(\"group\", \"day\"))\n\n# view\nx\n#>      group   day chick_id weight_g\n#>      <int> <int>    <int>    <int>\n#>   1:     1     0       18       39\n#>   2:     1     2       18       35\n#>   3:     1     0       16       41\n#>   4:     1     2       16       45\n#>   5:     1     4       16       49\n#>  ---                              \n#> 574:     4    14       48      170\n#> 575:     4    16       48      222\n#> 576:     4    18       48      261\n#> 577:     4    20       48      303\n#> 578:     4    21       48      322\n\n# source remains unchanged\ncw\n#>        day group chick_id weight_g\n#>      <int> <int>    <int>    <int>\n#>   1:     0     1       18       39\n#>   2:     2     1       18       35\n#>   3:     0     1       16       41\n#>   4:     2     1       16       45\n#>   5:     4     1       16       49\n#>  ---                              \n#> 574:    14     4       48      170\n#> 575:    16     4       48      222\n#> 576:    18     4       48      261\n#> 577:    20     4       48      303\n#> 578:    21     4       48      322\n```\n:::\n\n\n::: panel-tabset\n\n## [Exercise 3.2]{.important} \n\n- Create a copy of `cw` using `x <- copy(cw)`\n- In `x`, reorder the columns from left to right ID, group, day, weight. \n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- copy(cw)\nsetcolorder(x, c(\"chick_id\", \"group\", \"day\", \"weight_g\"))\nx\n#>      chick_id group   day weight_g\n#>         <int> <int> <int>    <int>\n#>   1:       18     1     0       39\n#>   2:       18     1     2       35\n#>   3:       16     1     0       41\n#>   4:       16     1     2       45\n#>   5:       16     1     4       49\n#>  ---                              \n#> 574:       48     4    14      170\n#> 575:       48     4    16      222\n#> 576:       48     4    18      261\n#> 577:       48     4    20      303\n#> 578:       48     4    21      322\n```\n:::\n\n:::\n\n## Column operations\n\n[`j` to transform a variable.]{.important} Use `:=` to transform column values in place, here, converting an integer to a double-precision number. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# modify values in an existing column\ncw[, weight_g := as.numeric(weight_g)]\n\n# view\ncw\n#>        day group chick_id weight_g\n#>      <int> <int>    <int>    <num>\n#>   1:     0     1       18       39\n#>   2:     2     1       18       35\n#>   3:     0     1       16       41\n#>   4:     2     1       16       45\n#>   5:     4     1       16       49\n#>  ---                              \n#> 574:    14     4       48      170\n#> 575:    16     4       48      222\n#> 576:    18     4       48      261\n#> 577:    20     4       48      303\n#> 578:    21     4       48      322\n```\n:::\n\n\nHere we use `paste0()` to add a prefix to the group number, converting the variable to a character type at the same time. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# modify values in an existing column\ncw[, group := paste0(\"diet \", group)]\n\n# view\ncw\n#>        day  group chick_id weight_g\n#>      <int> <char>    <int>    <num>\n#>   1:     0 diet 1       18       39\n#>   2:     2 diet 1       18       35\n#>   3:     0 diet 1       16       41\n#>   4:     2 diet 1       16       45\n#>   5:     4 diet 1       16       49\n#>  ---                               \n#> 574:    14 diet 4       48      170\n#> 575:    16 diet 4       48      222\n#> 576:    18 diet 4       48      261\n#> 577:    20 diet 4       48      303\n#> 578:    21 diet 4       48      322\n```\n:::\n\n\n\n::: panel-tabset\n\n## [Exercise 3.3]{.important} \n\n- Create a copy of `cw` using `x <- copy(cw)`\n- In `x`, add the prefix \"day\" to the day number, converting the variable to type character. \n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- copy(cw)\nx[, day := paste0(\"day \", day)]\nx\n#>         day  group chick_id weight_g\n#>      <char> <char>    <int>    <num>\n#>   1:  day 0 diet 1       18       39\n#>   2:  day 2 diet 1       18       35\n#>   3:  day 0 diet 1       16       41\n#>   4:  day 2 diet 1       16       45\n#>   5:  day 4 diet 1       16       49\n#>  ---                                \n#> 574: day 14 diet 4       48      170\n#> 575: day 16 diet 4       48      222\n#> 576: day 18 diet 4       48      261\n#> 577: day 20 diet 4       48      303\n#> 578: day 21 diet 4       48      322\n```\n:::\n\n:::\n\n\n*`j` to select variables.* &nbsp; Variables not listed are dropped. Here, for example, we drop the `chick_id` variable by not listing it. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# select columns \nx <- cw[, .(day, group, weight_g)]\n\n# view\nx\n#>        day  group weight_g\n#>      <int> <char>    <num>\n#>   1:     0 diet 1       39\n#>   2:     2 diet 1       35\n#>   3:     0 diet 1       41\n#>   4:     2 diet 1       45\n#>   5:     4 diet 1       49\n#>  ---                      \n#> 574:    14 diet 4      170\n#> 575:    16 diet 4      222\n#> 576:    18 diet 4      261\n#> 577:    20 diet 4      303\n#> 578:    21 diet 4      322\n```\n:::\n\n\n\n::: panel-tabset\n\n## [Exercise 3.4]{.important} \n\n- Create a copy of `cw` using `x <- copy(cw)`\n- In `x`, select all columns except `day`. \n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- copy(cw)\nx <- x[, .(chick_id, group, weight_g)]\nx\n#>      chick_id  group weight_g\n#>         <int> <char>    <num>\n#>   1:       18 diet 1       39\n#>   2:       18 diet 1       35\n#>   3:       16 diet 1       41\n#>   4:       16 diet 1       45\n#>   5:       16 diet 1       49\n#>  ---                         \n#> 574:       48 diet 4      170\n#> 575:       48 diet 4      222\n#> 576:       48 diet 4      261\n#> 577:       48 diet 4      303\n#> 578:       48 diet 4      322\n```\n:::\n\n:::\n\n\n*`j` to add a variable.* &nbsp; The new variable is added to the right of the other columns. Here, for example, we add the `weight_kg` variable. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add a column\ncw[, weight_kg := weight_g / 1000]\n\n# view\ncw\n#>        day  group chick_id weight_g weight_kg\n#>      <int> <char>    <int>    <num>     <num>\n#>   1:     0 diet 1       18       39     0.039\n#>   2:     2 diet 1       18       35     0.035\n#>   3:     0 diet 1       16       41     0.041\n#>   4:     2 diet 1       16       45     0.045\n#>   5:     4 diet 1       16       49     0.049\n#>  ---                                         \n#> 574:    14 diet 4       48      170     0.170\n#> 575:    16 diet 4       48      222     0.222\n#> 576:    18 diet 4       48      261     0.261\n#> 577:    20 diet 4       48      303     0.303\n#> 578:    21 diet 4       48      322     0.322\n```\n:::\n\n\n::: panel-tabset\n\n## [Exercise 3.5]{.important} \n\n- Create a copy of `cw` using `x <- copy(cw)`\n- In `x`, add a weight variable `weight_oz` in ounces (28.35 grams per ounce). Round the answer to the nearest tenth.\n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- copy(cw)\nx[, weight_oz := round(weight_g / 28.35, 1)]\nx\n#>        day  group chick_id weight_g weight_kg weight_oz\n#>      <int> <char>    <int>    <num>     <num>     <num>\n#>   1:     0 diet 1       18       39     0.039       1.4\n#>   2:     2 diet 1       18       35     0.035       1.2\n#>   3:     0 diet 1       16       41     0.041       1.4\n#>   4:     2 diet 1       16       45     0.045       1.6\n#>   5:     4 diet 1       16       49     0.049       1.7\n#>  ---                                                   \n#> 574:    14 diet 4       48      170     0.170       6.0\n#> 575:    16 diet 4       48      222     0.222       7.8\n#> 576:    18 diet 4       48      261     0.261       9.2\n#> 577:    20 diet 4       48      303     0.303      10.7\n#> 578:    21 diet 4       48      322     0.322      11.4\n```\n:::\n\n:::\n\n\n\n\n*`j` to delete a variable.* &nbsp; Assigning `NULL` by reference deletes the variable. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# delete a column\ncw[, weight_kg := NULL]\n\n# view\ncw\n#>        day  group chick_id weight_g\n#>      <int> <char>    <int>    <num>\n#>   1:     0 diet 1       18       39\n#>   2:     2 diet 1       18       35\n#>   3:     0 diet 1       16       41\n#>   4:     2 diet 1       16       45\n#>   5:     4 diet 1       16       49\n#>  ---                               \n#> 574:    14 diet 4       48      170\n#> 575:    16 diet 4       48      222\n#> 576:    18 diet 4       48      261\n#> 577:    20 diet 4       48      303\n#> 578:    21 diet 4       48      322\n```\n:::\n\n\n::: panel-tabset\n\n## [Exercise 3.6]{.important} \n\nUsing the `x` data frame from the previous exercise, delete the weight variables in grams and kilograms.\n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx[, weight_g := NULL]\nx[, weight_kg := NULL]\nx\n#>        day  group chick_id weight_oz\n#>      <int> <char>    <int>     <num>\n#>   1:     0 diet 1       18       1.4\n#>   2:     2 diet 1       18       1.2\n#>   3:     0 diet 1       16       1.4\n#>   4:     2 diet 1       16       1.6\n#>   5:     4 diet 1       16       1.7\n#>  ---                                \n#> 574:    14 diet 4       48       6.0\n#> 575:    16 diet 4       48       7.8\n#> 576:    18 diet 4       48       9.2\n#> 577:    20 diet 4       48      10.7\n#> 578:    21 diet 4       48      11.4\n```\n:::\n\n:::\n\n## Row operations\n\n*`i` to filter by values.* &nbsp; Use relational operators to compare values. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# subset by observation\ny <- cw[day == 21 & weight_g > 300]\n\n# view\ny\n#>      day  group chick_id weight_g\n#>    <int> <char>    <int>    <num>\n#> 1:    21 diet 1        7      305\n#> 2:    21 diet 2       29      309\n#> 3:    21 diet 2       21      331\n#> 4:    21 diet 3       32      305\n#> 5:    21 diet 3       40      321\n#> 6:    21 diet 3       34      341\n#> 7:    21 diet 3       35      373\n#> 8:    21 diet 4       48      322\n```\n:::\n\n\nFor comparing values in vectors use: `<` (less than), `>` (greater than), `<=` (less than or equal to), `>=` (greater than or equal to), `==` (equal to), and `!=` (not equal to). These can be combined logically using `&` (and) and `|` (or).\n\n::: panel-tabset\n\n## [Exercise 3.7]{.important} \n\n- Create a copy of `cw` using `x <- copy(cw)`\n- Filter `x` to retain all observations on day 4, diet 3 \n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- copy(cw)\nx <- x[day == 4 & group == \"diet 3\"]\nx\n#>       day  group chick_id weight_g\n#>     <int> <char>    <int>    <num>\n#>  1:     4 diet 3       33       63\n#>  2:     4 diet 3       37       56\n#>  3:     4 diet 3       36       61\n#>  4:     4 diet 3       31       62\n#>  5:     4 diet 3       39       61\n#>  6:     4 diet 3       38       61\n#>  7:     4 diet 3       32       65\n#>  8:     4 diet 3       40       66\n#>  9:     4 diet 3       34       63\n#> 10:     4 diet 3       35       64\n```\n:::\n\n:::\n\n\n\n\n*`i` to arrange rows.* &nbsp;\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# order rows by values in columns\ny <- cw[order(weight_g, day)]\n\n# view\ny\n#>        day  group chick_id weight_g\n#>      <int> <char>    <int>    <num>\n#>   1:     2 diet 1       18       35\n#>   2:     0 diet 1       18       39\n#>   3:     0 diet 2       27       39\n#>   4:     0 diet 2       28       39\n#>   5:     0 diet 2       29       39\n#>  ---                               \n#> 574:    21 diet 2       21      331\n#> 575:    18 diet 3       35      332\n#> 576:    21 diet 3       34      341\n#> 577:    20 diet 3       35      361\n#> 578:    21 diet 3       35      373\n```\n:::\n\n\n::: panel-tabset\n\n## [Exercise 3.8]{.important} \n\n- Create a copy of `cw` using `x <- copy(cw)`\n- Arrange rows of `x` by group and day\n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- copy(cw)\nx <- x[order(group, day)]\nx\n#>        day  group chick_id weight_g\n#>      <int> <char>    <int>    <num>\n#>   1:     0 diet 1       18       39\n#>   2:     0 diet 1       16       41\n#>   3:     0 diet 1       15       41\n#>   4:     0 diet 1       13       41\n#>   5:     0 diet 1        9       42\n#>  ---                               \n#> 574:    21 diet 4       49      237\n#> 575:    21 diet 4       46      238\n#> 576:    21 diet 4       50      264\n#> 577:    21 diet 4       42      281\n#> 578:    21 diet 4       48      322\n```\n:::\n\n:::\n\n\n*`i` to filter by index.* &nbsp; \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# subset by position\ny <- cw[1:10]\n\n# view\ny\n#>       day  group chick_id weight_g\n#>     <int> <char>    <int>    <num>\n#>  1:     0 diet 1       18       39\n#>  2:     2 diet 1       18       35\n#>  3:     0 diet 1       16       41\n#>  4:     2 diet 1       16       45\n#>  5:     4 diet 1       16       49\n#>  6:     6 diet 1       16       51\n#>  7:     8 diet 1       16       57\n#>  8:    10 diet 1       16       51\n#>  9:    12 diet 1       16       54\n#> 10:     0 diet 1       15       41\n```\n:::\n\n\n\n::: panel-tabset\n\n## [Exercise 3.9]{.important} \n\nUsing the `x` data frame from the previous exercise, filter to retain the last 10 rows.\n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- x[569:578]\nx\n#>       day  group chick_id weight_g\n#>     <int> <char>    <int>    <num>\n#>  1:    20 diet 4       48      303\n#>  2:    21 diet 4       45      196\n#>  3:    21 diet 4       43      200\n#>  4:    21 diet 4       41      204\n#>  5:    21 diet 4       47      205\n#>  6:    21 diet 4       49      237\n#>  7:    21 diet 4       46      238\n#>  8:    21 diet 4       50      264\n#>  9:    21 diet 4       42      281\n#> 10:    21 diet 4       48      322\n```\n:::\n\n:::\n\n## Group and summarize\n\n*`by` to count.* &nbsp; `.N` is a data.table function that yields the number of observations (rows) in a group identified with the `by` argument.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# count number of chicks by diet group\ny <- cw[, .(N_chicks = .N), by = c(\"group\")]\n\n# view\ny\n#>     group N_chicks\n#>    <char>    <int>\n#> 1: diet 1      220\n#> 2: diet 2      120\n#> 3: diet 3      120\n#> 4: diet 4      118\n```\n:::\n\n\n\n::: panel-tabset\n\n## [Exercise 3.10]{.important} \n\n- Create a copy of `cw` using `x <- copy(cw)`\n- Count the number of observations by day. Name the variable `count`\n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- copy(cw)\nx <- x[, .(count = .N), by = c(\"day\")]\nx\n#>       day count\n#>     <int> <int>\n#>  1:     0    50\n#>  2:     2    50\n#>  3:     4    49\n#>  4:     6    49\n#>  5:     8    49\n#>  6:    10    49\n#>  7:    12    49\n#>  8:    14    48\n#>  9:    16    47\n#> 10:    18    47\n#> 11:    20    46\n#> 12:    21    45\n```\n:::\n\n:::\n\n\n*`by` to summarize.* &nbsp; Yields three new variables for count, mean, and standard deviation by the two grouping variables `group` and `day`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# compute summary statistics grouped by two variables\ny <- cw[,                                         # i (empty)\n        .(N_chicks = .N,                          # j\n          mean_wt_g = round(mean(weight_g), 1),   # j (cont.)\n          std_dev_wt_g = round(sd(weight_g), 1)), # j (cont.)\n        by = c(\"group\", \"day\")]                   # by\n\n# view\ny\n#>      group   day N_chicks mean_wt_g std_dev_wt_g\n#>     <char> <int>    <int>     <num>        <num>\n#>  1: diet 1     0       20      41.4          1.0\n#>  2: diet 1     2       20      47.2          4.3\n#>  3: diet 1     4       19      56.5          4.1\n#>  4: diet 1     6       19      66.8          7.8\n#>  5: diet 1     8       19      79.7         13.8\n#> ---                                             \n#> 44: diet 4    14       10     161.8         15.7\n#> 45: diet 4    16       10     182.0         25.3\n#> 46: diet 4    18       10     202.9         33.6\n#> 47: diet 4    20        9     233.9         37.6\n#> 48: diet 4    21        9     238.6         43.3\n```\n:::\n\n\n\n::: panel-tabset\n\n## [Exercise 3.11]{.important}\n\n- Create a copy of `cw` using `x <- copy(cw)`\n- Count the number of chicks in `x` by group and day. Name the variable `count`\n\n## Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- copy(cw)\nx <- x[, .(count = .N), by = c(\"group\", \"day\")]\nx\n#>      group   day count\n#>     <char> <int> <int>\n#>  1: diet 1     0    20\n#>  2: diet 1     2    20\n#>  3: diet 1     4    19\n#>  4: diet 1     6    19\n#>  5: diet 1     8    19\n#> ---                   \n#> 44: diet 4    14    10\n#> 45: diet 4    16    10\n#> 46: diet 4    18    10\n#> 47: diet 4    20     9\n#> 48: diet 4    21     9\n```\n:::\n\n:::\n\n\n## Combine operations\n\n*`[i, j, by]` in combination.* &nbsp; In this example, we use `i` to filter for two specific days, `j` to create new summary variables grouped `by` variables `group` and `day`. The results are the count `N` plus weight statistics: mean, standard deviation, median, minimum, and maximum. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# grouped summaries of specific observations\ncw_stats <- cw[day %in% c(0, 21),                         # i\n               .(N = .N,                                  # j\n                 mean_wt_g    = round(mean(weight_g), 0), # j (cont.)\n                 std_dev_wt_g = round(sd(weight_g), 1),   # j (cont.)\n                 median_wt_g  = median(weight_g),         # j (cont.)\n                 min_wt_g     = min(weight_g),            # j (cont.)\n                 max_wt_g     = max(weight_g)),           # j (cont.)\n               by = .(group, day)]                        # by\n\n# view\ncw_stats\n#>     group   day     N mean_wt_g std_dev_wt_g median_wt_g min_wt_g max_wt_g\n#>    <char> <int> <int>     <num>        <num>       <num>    <num>    <num>\n#> 1: diet 1     0    20        41          1.0        41.0       39       43\n#> 2: diet 1    21    16       178         58.7       166.0       96      305\n#> 3: diet 2     0    10        41          1.5        40.5       39       43\n#> 4: diet 2    21    10       215         78.1       212.5       74      331\n#> 5: diet 3     0    10        41          1.0        41.0       39       42\n#> 6: diet 3    21    10       270         71.6       281.0      147      373\n#> 7: diet 4     0    10        41          1.1        41.0       39       42\n#> 8: diet 4    21     9       239         43.3       237.0      196      322\n```\n:::\n\n\n\n## Create a table \n\nFinally, we can make the summaries \"prettier\" for a possible report or publication where we format the numeric values as text and edit the column names for readability just before printing. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# combine mean and std dev into a single character column\ncw_stats[, mean_sd := paste0(mean_wt_g, \" (\", std_dev_wt_g, \")\")]\n\n# combine min and max into a range column\ncw_stats[, range := paste0(min_wt_g, \"--\", max_wt_g)]\n\n# retain specific columns\ncw_stats <- cw_stats[ , .(group, day, N, mean_sd, median_wt_g, range)]\n\n# order the rows\ncw_stats <- cw_stats[order(group, day)]\n\n# edit the column names for readability \nsetnames(cw_stats,\n         old = c(\"group\", \"day\", \"median_wt_g\",\"mean_sd\", \"range\"),\n         new = c(\"Group\", \"Day\", \"Median\", \"Mean [SD]\", \"Range\"))\n\n# view\ncw_stats\n#>     Group   Day     N  Mean [SD] Median    Range\n#>    <char> <int> <int>     <char>  <num>   <char>\n#> 1: diet 1     0    20     41 (1)   41.0   39--43\n#> 2: diet 1    21    16 178 (58.7)  166.0  96--305\n#> 3: diet 2     0    10   41 (1.5)   40.5   39--43\n#> 4: diet 2    21    10 215 (78.1)  212.5  74--331\n#> 5: diet 3     0    10     41 (1)   41.0   39--42\n#> 6: diet 3    21    10 270 (71.6)  281.0 147--373\n#> 7: diet 4     0    10   41 (1.1)   41.0   39--42\n#> 8: diet 4    21     9 239 (43.3)  237.0 196--322\n```\n:::\n\n\nEventually you should be able to produce a publication-ready version such as the following table, using Rmarkdown and the knitr package. Full details are available in other sources.\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nTable: Table 1. Chick weight summary statistics (grams).\n\n|Group  | Day|  N|  Mean [SD]| Median|    Range|\n|:------|---:|--:|----------:|------:|--------:|\n|diet 1 |   0| 20|     41 (1)|   41.0|   39--43|\n|diet 1 |  21| 16| 178 (58.7)|  166.0|  96--305|\n|diet 2 |   0| 10|   41 (1.5)|   40.5|   39--43|\n|diet 2 |  21| 10| 215 (78.1)|  212.5|  74--331|\n|diet 3 |   0| 10|     41 (1)|   41.0|   39--42|\n|diet 3 |  21| 10| 270 (71.6)|  281.0| 147--373|\n|diet 4 |   0| 10|   41 (1.1)|   41.0|   39--42|\n|diet 4 |  21|  9| 239 (43.3)|  237.0| 196--322|\n\n\n:::\n:::\n\n\n*Interpretation.* &nbsp; This summary table offers similar results to those revealed in the charts, \n\n- in day 21, diet 3 has the highest mean and median weights \n- in day 21, diet 4 has the least variability in weight\n\nIn addition, we note that by day 21, diet 1 lost 4 chicks of 20 that started and diet 4 lost 1 of 10. This could be a sign of unsafe conditions. \n\n\n## Conclusion\n\nThe *R basics*, *R chart basics*, and *R data basics* guides introduced you to some of the basic concepts for using R and the data.table and ggplot2 packages  to manipulate data and create charts. It is only an introduction to what R can do but hopefully you have seen some of the potential of using R for data science.\n\n[Next steps.]{.important} There are plenty of R courses, books, and online resources that you can learn from. Find things that work for you and don't be afraid to make mistakes or ask questions. \n\nDuring the MIDFIELD workshops, you will build on what you've learned here, and use the midfieldr package to study student unit records. You can preview that material on the [midfieldr](https://midfieldr.github.io/midfieldr/) website. \n \n\n\n## References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}